<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>无媛无故 - wangchloe的个人博客</title>
  
  <subtitle>(๑•ᴗ•๑)做一个有记性有温度不掉发的程序媛！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://wangchloe.vip/"/>
  <updated>2019-07-24T06:30:13.036Z</updated>
  <id>https://wangchloe.vip/</id>
  
  <author>
    <name>Chloe Wang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NativeApi思考</title>
    <link href="https://wangchloe.vip/2019/07/23/blog43/"/>
    <id>https://wangchloe.vip/2019/07/23/blog43/</id>
    <published>2019-07-22T19:27:35.000Z</published>
    <updated>2019-07-24T06:30:13.036Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><!-- MarkdownTOC --><ul><li>NativeApi思考<ul><li>以调用Native上传图片组件为例</li><li>Hybrid通信原理<ul><li>JS Bridge</li></ul></li></ul></li></ul><!-- /MarkdownTOC --><a id="more"></a><h2 id="NativeApi思考"><a href="#NativeApi思考" class="headerlink" title="NativeApi思考"></a>NativeApi思考</h2><p>“//webapp/js/common/hybridapi/nativefunction.js”,</p><h3 id="以调用Native上传图片组件为例"><a href="#以调用Native上传图片组件为例" class="headerlink" title="以调用Native上传图片组件为例"></a>以调用Native上传图片组件为例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    NS.register(<span class="string">"NativeApi"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 目前Android webview不支持type=file事件，通过协议解决：</span></span><br><span class="line">    <span class="comment">// 定义全局函数用于回调 </span></span><br><span class="line">    <span class="built_in">window</span>[<span class="string">"nativeTakePhotoCallback"</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">result, url, ud</span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//options参数若有相同项，则替换$.extend内的第三个&#123;&#125;类目</span></span><br><span class="line">    NS.NativeApi.add(<span class="string">"takePhoto"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>, &#123;&#125;, &#123;</span><br><span class="line">            imgMaxWidth: <span class="number">640</span>,</span><br><span class="line">            uploadUrl: <span class="string">"&#123;0&#125;xiaozu/ajaxUploadImg"</span>.format(currentApiRoot),</span><br><span class="line">            userData: <span class="string">""</span>,</span><br><span class="line">            t: <span class="number">0</span>,</span><br><span class="line">            callback: <span class="string">"nativeTakePhotoCallback"</span></span><br><span class="line">        &#125;, options);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> protocol = <span class="string">"ns://&#123;0&#125;/dev/takephoto?cb=&#123;1&#125;&amp;w=&#123;2&#125;&amp;ud=&#123;3&#125;&amp;upload=&#123;4&#125;&amp;t=&#123;5&#125;"</span></span><br><span class="line">            .format(domain,</span><br><span class="line">                rebuildCallback(settings.callback),</span><br><span class="line">                settings.imgMaxWidth,</span><br><span class="line">                settings.userData,</span><br><span class="line">                <span class="comment">// 把字符串作为 URI 组件进行编码，其中的某些字符将被十六进制的转义序列进行替换。</span></span><br><span class="line">                <span class="comment">// eg: : -&gt; %3A   / -&gt; %2F</span></span><br><span class="line">                <span class="built_in">encodeURIComponent</span>(settings.uploadUrl),</span><br><span class="line">                settings.t);</span><br><span class="line">        connectApp(protocol);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// js Bridge建立Native与H5间通信</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">connectApp</span>(<span class="params">protocol</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</span><br><span class="line">        <span class="keyword">var</span> iframeStyle = <span class="built_in">document</span>.createAttribute(<span class="string">"style"</span>);</span><br><span class="line">        <span class="keyword">var</span> iframeSrc = <span class="built_in">document</span>.createAttribute(<span class="string">"src"</span>);</span><br><span class="line"></span><br><span class="line">        iframeStyle.nodeValue = <span class="string">"display:none;width:0;height:0;"</span>;</span><br><span class="line">        iframeSrc.nodeValue = protocol;</span><br><span class="line">        iframe.setAttributeNode(iframeStyle);</span><br><span class="line">        iframe.setAttributeNode(iframeSrc);</span><br><span class="line">        <span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line"></span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.body.removeChild(iframe);</span><br><span class="line">        &#125;, <span class="number">250</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rebuildCallback</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> t = cb;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($.isFunction(cb)) &#123;</span><br><span class="line">            t = <span class="string">"hybrid_"</span> + (+<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">            <span class="built_in">window</span>[t] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">// 将具有length属性的对象转成数组</span></span><br><span class="line">                cb.apply(<span class="literal">null</span>, <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">0</span>));</span><br><span class="line">                <span class="keyword">delete</span> <span class="built_in">window</span>[t];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><hr><ul><li>format传入参数实现</li></ul><p>“//webapp/js/base.js”,<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="built_in">String</span>.prototype.format = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> temS = <span class="keyword">this</span>, i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; ++i) &#123;</span><br><span class="line">            temS = temS.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"\\&#123;"</span> + i + <span class="string">"\\&#125;"</span>, <span class="string">"g"</span>), <span class="built_in">arguments</span>[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> temS;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li><code>+new Date()</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    s = <span class="keyword">new</span> <span class="built_in">Date</span>().toString();</span><br><span class="line">    <span class="comment">// "Wed May 17 2017 11:00:16 GMT+0800 (中国标准时间)"</span></span><br><span class="line"></span><br><span class="line">    t = (+<span class="keyword">new</span> <span class="built_in">Date</span>()).toString();</span><br><span class="line">    <span class="comment">// "1494990039861"</span></span><br><span class="line">    <span class="comment">// +new Date(); 等同于 new Date().getTime(); 简略写法，得到毫秒</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>Array.prototype.slice.call(arguments, 0)</code>剖析</li></ul><p>将具有length属性的对象转成数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">//ES5 中的数组方法slice的底层内部实现</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.slice=<span class="function"><span class="keyword">function</span>(<span class="params">start,end</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Array</span>(); <span class="comment">//新数组</span></span><br><span class="line">    <span class="keyword">var</span> start = start || <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> end = end || <span class="keyword">this</span>.length; <span class="comment">//this指向调用的对象，用了call之后，改变this的指向，指向传进来的对象</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=start; i&lt;end; i++)&#123;</span><br><span class="line">        result.push(<span class="keyword">this</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;<span class="comment">//返回的为一个新的数组</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// 传入arguments类数组，调用Array.prototype.slice原型方法</span></span><br><span class="line">    <span class="comment">// 并用call()方法，将作用域限定在arguments中</span></span><br><span class="line">    <span class="comment">// 这里Array.prototype就可以理解为arguments</span></span><br><span class="line">    <span class="comment">// 参数0为slice()方法的第一个参数，即开始位置索引，返回整个数组。</span></span><br><span class="line">    <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">0</span>);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><ul><li>JS Bridge建立Native与H5间通信</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connectApp</span>(<span class="params">protocol</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</span><br><span class="line">    <span class="keyword">var</span> iframeStyle = <span class="built_in">document</span>.createAttribute(<span class="string">"style"</span>);</span><br><span class="line">    <span class="keyword">var</span> iframeSrc = <span class="built_in">document</span>.createAttribute(<span class="string">"src"</span>);</span><br><span class="line"></span><br><span class="line">    iframeStyle.nodeValue = <span class="string">"display:none;width:0;height:0;"</span>;</span><br><span class="line">    iframeSrc.nodeValue = protocol;</span><br><span class="line">    iframe.setAttributeNode(iframeStyle);</span><br><span class="line">    iframe.setAttributeNode(iframeSrc);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line"></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.body.removeChild(iframe);</span><br><span class="line">    &#125;, <span class="number">250</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Hybrid通信原理"><a href="#Hybrid通信原理" class="headerlink" title="Hybrid通信原理"></a>Hybrid通信原理</h3><p>背景：原生APP开发中有一个webview的组件(Android中是webview,iOS7以下有UIWebview,7以上有WKWebview),这个组件可以加载Html文件。</p><ul><li><p>IOS</p><ul><li>Object-C可直接调用js，只需调用stringByEvaluatingJavaScriptFromString即可，可直接获取js返回值。</li><li>js不可直接调用Object-C，利用 shouldStartLoadWithRequest，需拦截每个url，对指定的schema进行拦截做相应的本地方法。</li></ul></li><li><p>Android</p><ul><li>Java可直接调用js，但不可直接获取js返回值。</li><li>Java注册addJavascriptInterface 后，js可直接调用Native的接口，并获取Native的返回值。<a href="http://www.alloyteam.com/2013/02/rang-java-gen-javascript-geng-jia-qin-mi/" target="_blank" rel="noopener">让Java跟Javascript更加亲密</a></li><li>通过 shouldOverrideUrlLoading，也还是拦截Web的所有URL请求来达到通信的目的。</li></ul></li></ul><p><strong>基础通信存在以下问题</strong></p><ul><li><p>Android4.2以下,addJavascriptInterface方式有安全漏洞</p></li><li><p>iOS7以下,js无法调用Native</p></li></ul><h4 id="JS-Bridge"><a href="#JS-Bridge" class="headerlink" title="JS Bridge"></a>JS Bridge</h4><ul><li>url scheme交互方式是一套现有的成熟方案，可以完美兼容各种版本，不存在上述问题。</li></ul><p>通过JSBridge(JS和Native通信机制),H5页面可以调用Native的api,Native也可调用H5页面的方法或者通知H5页面回调。</p><p><img src="https://dailc.github.io/staticResource/blog/hybrid/jsbridge/img_hybrid_base_jsbridgePrinciple_1.png?_=5931322" alt="JSBridge的核心原理"></p><p>原理：<br>（1）初始化创建的一个style.display=none 的iframe,并将iframe.src设置为自有协议，每次js需要与Native通信时，js端主动调用iframe.src即可，Native收到请求通知后，反向调用fetchQueue(可见源码)获取消息内容；若Native需要与js通信，直接调用js，并获取返回值</p><p>（2）</p><ul><li><p>IOS<br>js-&gt;Native：js将要发送的消息存放在js端-&gt;调用iframe.src，触发通知Native-&gt;Native拦截请求，调用js bridge里面的fetchQueue并获取返回的消息内容，处理消息-&gt;将需要返回的数据通过直接调用js的方式，让js处理</p></li><li><p>Android<br>js-&gt;Native: 通过 shouldOverrideUrlLoading 携带Js的返回值<br>（3）Native-&gt;js: Native可直接调用Js并获取返回的内容</p></li></ul><p><a href="http://www.cnblogs.com/dailc/p/5930231.html" target="_blank" rel="noopener">连续五篇讲述Hybrid以及JSBridge解决方案</a></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;!-- MarkdownTOC --&gt;
&lt;ul&gt;
&lt;li&gt;NativeApi思考&lt;ul&gt;
&lt;li&gt;以调用Native上传图片组件为例&lt;/li&gt;
&lt;li&gt;Hybrid通信原理&lt;ul&gt;
&lt;li&gt;JS Bridge&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="webview" scheme="https://wangchloe.vip/tags/webview/"/>
    
  </entry>
  
  <entry>
    <title>video.js小记</title>
    <link href="https://wangchloe.vip/2019/06/25/blog55/"/>
    <id>https://wangchloe.vip/2019/06/25/blog55/</id>
    <published>2019-06-25T07:34:01.000Z</published>
    <updated>2019-06-25T07:34:01.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><!-- MarkdownTOC --><ul><li>1.chrome video不能自动播放</li><li><ol start="2"><li>videojs暂停后不能播放</li></ol></li><li>3.iOS 10+ 新政策。</li><li><ol start="4"><li>Refused to create worker from blob</li></ol></li></ul><!-- /MarkdownTOC --><a id="more"></a><p><a href="https://www.awaimai.com/2053.html" target="_blank" rel="noopener">video.js使用技巧</a></p><h3 id="1-chrome-video不能自动播放"><a href="#1-chrome-video不能自动播放" class="headerlink" title="1.chrome video不能自动播放"></a>1.chrome video不能自动播放</h3><ul><li>方法一</li></ul><p>在chrome 浏览器中输入：chrome://flags，搜索“Autoplay policy”，默认为“Default”，</p><p>修改为 “No user gesture is required” </p><ul><li>方法二</li></ul><p>在使用video标签的过程中，设置静音播放</p><h3 id="2-videojs暂停后不能播放"><a href="#2-videojs暂停后不能播放" class="headerlink" title="2. videojs暂停后不能播放"></a>2. videojs暂停后不能播放</h3><p>需使用source配置video资源</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">"J_video_wrap"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"video-js video-box"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"video"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">controls</span></span></span><br><span class="line"><span class="tag">    <span class="attr">preload</span>=<span class="string">"auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">autoplay</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x-webkit-airplay</span>=<span class="string">"allow"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">webkit-playsinline</span></span></span><br><span class="line"><span class="tag">    <span class="attr">playsinline</span></span></span><br><span class="line"><span class="tag">   <span class="attr">poster</span>=<span class="string">"&#123;$video.img&#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">src</span>=<span class="string">"&#123;$video.link&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">"J_video_wrap"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"video-js video-box"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"video"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">controls</span></span></span><br><span class="line"><span class="tag">    <span class="attr">preload</span>=<span class="string">"auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">autoplay</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x-webkit-airplay</span>=<span class="string">"allow"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">webkit-playsinline</span></span></span><br><span class="line"><span class="tag">    <span class="attr">playsinline</span></span></span><br><span class="line"><span class="tag">   <span class="attr">poster</span>=<span class="string">"&#123;$video.img&#125;"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"&#123;$video.link&#125;"</span> <span class="attr">type</span>=<span class="string">"video/mp4"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-iOS-10-新政策。"><a href="#3-iOS-10-新政策。" class="headerlink" title="3.iOS 10+ 新政策。"></a>3.iOS 10+ 新政策。</h3><p>在省电模式下无法自动播放视频。android任何模式都不能自动播放，只能让用户手动触发</p><h3 id="4-Refused-to-create-worker-from-blob"><a href="#4-Refused-to-create-worker-from-blob" class="headerlink" title="4. Refused to create worker from blob"></a>4. Refused to create worker from blob</h3><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g5b2chlepnj30tj01xdgf.jpg" alt=""></p><p>解决：</p><p><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g5b2ckq6f6j30tj06l3zq.jpg" alt=""></p><p>在header的CSP(Content Security Policy ,内容安全策略)处添加blob:</p><p><a href="https://www.cnblogs.com/heyuqing/p/6215761.html" target="_blank" rel="noopener">前端安全配置之Content-Security-Policy(csp)</a></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;!-- MarkdownTOC --&gt;
&lt;ul&gt;
&lt;li&gt;1.chrome video不能自动播放&lt;/li&gt;
&lt;li&gt;&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;videojs暂停后不能播放&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;3.iOS 10+ 新政策。&lt;/li&gt;
&lt;li&gt;&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Refused to create worker from blob&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="项目总结" scheme="https://wangchloe.vip/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    
      <category term="video.js" scheme="https://wangchloe.vip/tags/video-js/"/>
    
  </entry>
  
  <entry>
    <title>visibilitychange监听回到当前webview</title>
    <link href="https://wangchloe.vip/2019/05/24/blog50/"/>
    <id>https://wangchloe.vip/2019/05/24/blog50/</id>
    <published>2019-05-24T06:47:24.000Z</published>
    <updated>2019-07-24T06:58:36.709Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">appSubsribe: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">"visibilitychange"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">document</span>.hidden) &#123;</span><br><span class="line">            that.fetchData();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="webview" scheme="https://wangchloe.vip/tags/webview/"/>
    
  </entry>
  
  <entry>
    <title>那些prototype那些call</title>
    <link href="https://wangchloe.vip/2019/05/13/blog46/"/>
    <id>https://wangchloe.vip/2019/05/13/blog46/</id>
    <published>2019-05-12T19:27:35.000Z</published>
    <updated>2019-07-24T06:28:15.653Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><p>原型链大法好！</p><a id="more"></a><h3 id="Array-prototype-slice-call-arguments-0-将具有length属性的对象转成数组"><a href="#Array-prototype-slice-call-arguments-0-将具有length属性的对象转成数组" class="headerlink" title="Array.prototype.slice.call(arguments, 0)  将具有length属性的对象转成数组"></a><code>Array.prototype.slice.call(arguments, 0)</code>  将具有length属性的对象转成数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">//ES5 中的数组方法slice的底层内部实现</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.slice=<span class="function"><span class="keyword">function</span>(<span class="params">start,end</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Array</span>(); <span class="comment">//新数组</span></span><br><span class="line">    <span class="keyword">var</span> start = start || <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> end = end || <span class="keyword">this</span>.length; <span class="comment">//this指向调用的对象，用了call之后，改变this的指向，指向传进来的对象</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=start; i&lt;end; i++)&#123;</span><br><span class="line">        result.push(<span class="keyword">this</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;<span class="comment">//返回的为一个新的数组</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// 传入arguments类数组，调用Array.prototype.slice原型方法</span></span><br><span class="line">    <span class="comment">// 并用call()方法，将作用域限定在arguments中</span></span><br><span class="line">    <span class="comment">// 这里Array.prototype就可以理解为arguments</span></span><br><span class="line">    <span class="comment">// 参数0为slice()方法的第一个参数，即开始位置索引，返回整个数组。</span></span><br><span class="line">    <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">0</span>);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Object-prototype-toString-call-xxx-检查对象类型"><a href="#Object-prototype-toString-call-xxx-检查对象类型" class="headerlink" title="Object.prototype.toString.call(xxx)  检查对象类型"></a><code>Object.prototype.toString.call(xxx)</code>  检查对象类型</h3><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1flaq2qoy21j309l06vjsa.jpg" alt="Object.prototype.toString.call"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> InputValidation = &#123;</span><br><span class="line">    <span class="string">"isNumber"</span>: <span class="function"><span class="keyword">function</span> (<span class="params">intArg</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(intArg) === <span class="string">"[object Number]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">InputValidation.isNumber(<span class="number">111</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.cnblogs.com/youhong/p/6209054.html" target="_blank" rel="noopener">为什么用Object.prototype.toString.call(obj)检测对象类型?</a><br>toString为Object的原型方法，而Array 、Function等类型作为Object的实例，都重写了toString方法。不同的对象类型调用toString方法时，根据原型链的知识，调用的是对应的重写之后的toString方法（Function类型返回内容为函数体的字符串，Array类型返回元素组成的字符串…..），而不会去调用Object上原型toString方法（返回对象的具体类型），所以采用obj.toString()不能得到其对象类型，只能将obj转换为字符串类型；因此，在想要得到对象的具体类型时，应该调用Object上原型toString方法。</p></blockquote><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;原型链大法好！&lt;/p&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="js" scheme="https://wangchloe.vip/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>更改微信内分享链接</title>
    <link href="https://wangchloe.vip/2019/05/10/blog45/"/>
    <id>https://wangchloe.vip/2019/05/10/blog45/</id>
    <published>2019-05-09T19:27:35.000Z</published>
    <updated>2019-07-24T06:28:10.972Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">wx.ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 分享给朋友</span></span><br><span class="line">    wx.onMenuShareAppMessage(&#123;</span><br><span class="line">        link: shareUrl,</span><br><span class="line">        title: wxFanliConfig.session.title,</span><br><span class="line">        desc: wxFanliConfig.session.desc,</span><br><span class="line">        imgUrl: wxFanliConfig.session.img,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (wagv.inWeiXin &amp;&amp; <span class="keyword">typeof</span> wagv.inWeiXin[<span class="string">"shareAppSuccess"</span>] == <span class="string">"function"</span>) &#123;</span><br><span class="line">                wagv.inWeiXin[<span class="string">"shareAppSuccess"</span>]();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        fail: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">'分享失败'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分享到朋友圈</span></span><br><span class="line">    wx.onMenuShareTimeline(&#123;</span><br><span class="line">        link: shareUrl,</span><br><span class="line">        title: wxFanliConfig.timeline.title,</span><br><span class="line">        desc: wxFanliConfig.timeline.desc,</span><br><span class="line">        imgUrl: wxFanliConfig.timeline.img,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (wagv.inWeiXin &amp;&amp; <span class="keyword">typeof</span> wagv.inWeiXin[<span class="string">"shareTimelineSuccess"</span>] == <span class="string">"function"</span>) &#123;</span><br><span class="line">                wagv.inWeiXin[<span class="string">"shareTimelineSuccess"</span>]();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        fail: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">'分享失败'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="微信" scheme="https://wangchloe.vip/tags/%E5%BE%AE%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>巴适川渝</title>
    <link href="https://wangchloe.vip/2019/05/04/life7/"/>
    <id>https://wangchloe.vip/2019/05/04/life7/</id>
    <published>2019-05-03T19:12:48.000Z</published>
    <updated>2019-07-23T09:41:35.558Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>巴适滴狠！</p><a id="more"></a><hr><p><a href="https://v.vuevideo.net/share/post/7699160849240349086" target="_blank" rel="noopener">wangchloe 的 Vlog | 巴适川渝</a></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;巴适滴狠！&lt;/p&gt;
    
    </summary>
    
      <category term="你好，陌生人" scheme="https://wangchloe.vip/categories/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E9%99%8C%E7%94%9F%E4%BA%BA/"/>
    
    
      <category term="爱旅游" scheme="https://wangchloe.vip/tags/%E7%88%B1%E6%97%85%E6%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>Intellij IDEA建立mac下java开发环境</title>
    <link href="https://wangchloe.vip/2019/04/05/blog44/"/>
    <id>https://wangchloe.vip/2019/04/05/blog44/</id>
    <published>2019-04-04T19:27:35.000Z</published>
    <updated>2019-07-24T06:13:41.451Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><ul><li><code>commond+T</code> 拉取分支</li><li><code>commond+k</code> 提交分枝</li><li><code>shift+shift</code> 全局搜索文件名</li><li><code>control+shift+f</code> 全局搜索内容(.do)</li><li><p><code>command+command</code> maven projects</p><a id="more"></a></li><li><p>文件名 mall.properties 本地查看html效果</p></li><li>文件名 page-config.xml 配置css、js</li><li>新建分支</li></ul><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fm5o3mjyi1j30l10om114.jpg" alt="新建分支"><br><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g5awgmpl9qj30nc0qetgv.jpg" alt="新建分支"></p><blockquote><p>新建分支后更改mall.properties文件内容，增加端口号</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mall.common.api.url=http://service.shzyfl.cn:7101</span><br></pre></td></tr></table></figure><ul><li>端口占用解决方法<br>终端输入占用端口号10100<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i:10100</span><br></pre></td></tr></table></figure></li></ul><p>显示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COMMAND  PID    USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME</span><br><span class="line">java    1372 wangjie   18u  IPv6 0x40969a7cc34a9943      0t0  TCP *:itap-ddtp (LISTEN)</span><br></pre></td></tr></table></figure></p><p>kill该端口进程PID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 1372</span><br></pre></td></tr></table></figure></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;commond+T&lt;/code&gt; 拉取分支&lt;/li&gt;
&lt;li&gt;&lt;code&gt;commond+k&lt;/code&gt; 提交分枝&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shift+shift&lt;/code&gt; 全局搜索文件名&lt;/li&gt;
&lt;li&gt;&lt;code&gt;control+shift+f&lt;/code&gt; 全局搜索内容(.do)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;command+command&lt;/code&gt; maven projects&lt;/p&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="java" scheme="https://wangchloe.vip/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>征服宝岛～</title>
    <link href="https://wangchloe.vip/2019/04/01/life6/"/>
    <id>https://wangchloe.vip/2019/04/01/life6/</id>
    <published>2019-03-31T19:12:48.000Z</published>
    <updated>2019-07-23T09:38:45.104Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>世界多大，老汪的脚步就迈多大！PS：🇨🇳台湾真好吃</p><a id="more"></a><p><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59wjj0d8wj31bq0u0e82.jpg" alt="史上超强自制攻略"></p><hr><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g59wqi6df9j30rs15oaix.jpg" alt=""><br><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g59wqi0bnnj30rs15owln.jpg" alt=""><br><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g59wqhui4kj30rs15ogt1.jpg" alt=""><br><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g59wqghp3uj30u00u0dlc.jpg" alt=""><br><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g59wqfxuvtj30u00u0wjj.jpg" alt=""><br><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g59wqfrqfej30rs15o12k.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59wqhp5r4j30u00u0thd.jpg" alt=""><br><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g59wqhighuj30u00u0gw4.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59wqgn8gyj30u00u047u.jpg" alt=""></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;世界多大，老汪的脚步就迈多大！PS：🇨🇳台湾真好吃&lt;/p&gt;
    
    </summary>
    
      <category term="你好，陌生人" scheme="https://wangchloe.vip/categories/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E9%99%8C%E7%94%9F%E4%BA%BA/"/>
    
    
      <category term="爱旅游" scheme="https://wangchloe.vip/tags/%E7%88%B1%E6%97%85%E6%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>承接页问题汇总</title>
    <link href="https://wangchloe.vip/2019/03/25/blog52/"/>
    <id>https://wangchloe.vip/2019/03/25/blog52/</id>
    <published>2019-03-25T07:00:04.000Z</published>
    <updated>2019-07-24T07:00:04.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><a id="more"></a><h2 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h2><ul><li><p>承接页</p><ul><li>单个商品+品牌一排一个商品+猜你喜欢一排两列商品</li><li><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g1etu8gs40j30u03q6b2c.jpg" alt=""></li><li>置顶效果</li><li><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g1etv6irx8j30u01hd1kx.jpg" alt=""></li></ul></li><li><p>品牌页</p><ul><li>品牌一排一个商品+猜你喜欢一排两列商品</li><li><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g1etvs203qj30u02uzx6q.jpg" alt=""></li><li>置顶效果</li><li><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g1etvuyy5lj30u02uzhdv.jpg" alt=""></li></ul></li></ul><h2 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h2><h3 id="1-有fixed-bar的情况下还需优惠券置顶"><a href="#1-有fixed-bar的情况下还需优惠券置顶" class="headerlink" title="1. 有fixed bar的情况下还需优惠券置顶"></a>1. 有fixed bar的情况下还需优惠券置顶</h3><ul><li><p>方案1: append <code>$(&quot;.page-bar&quot;).append($(&quot;#J_coupon&quot;))</code>✘</p><ul><li>优点：不需要为<code>$(&quot;#J_coupon&quot;)</code>增加fixed样式</li><li>缺点：如果券已向右滑动，不便于保持滑动状态，需iscroll/记录translateX(..)</li></ul></li><li><p>方案2: <code>$(&quot;#J_coupon.fixed&quot;)</code> ✔︎</p><ul><li>优点：能保持券状态</li><li>缺点：需要为<code>$(&quot;#J_coupon&quot;)</code>增加fixed样式</li></ul></li></ul><h3 id="2-滚动需监听事件颇多-目前方案不是最优"><a href="#2-滚动需监听事件颇多-目前方案不是最优" class="headerlink" title="2. 滚动需监听事件颇多 (目前方案不是最优)"></a>2. 滚动需监听事件颇多 (目前方案不是最优)</h3><ul><li><strong>bar</strong></li><li><strong>券</strong></li><li><strong>查看更多xx件商品</strong></li><li><strong>右下角置顶按钮</strong><ul><li>品牌商品数量 &gt; 20<ul><li>下滑 展示当前已浏览数量</li><li>上滑 展示置顶按钮</li></ul></li><li>品牌商品数量 &lt;= 20<ul><li>展示置顶按钮</li></ul></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">bindScroll: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $relate = $(<span class="string">"#J_relate"</span>);</span><br><span class="line">    <span class="keyword">var</span> $brand = $(<span class="string">"#J_brand"</span>);</span><br><span class="line">    <span class="keyword">var</span> $coupon = $(<span class="string">"#J_coupon"</span>);</span><br><span class="line">    <span class="keyword">var</span> $couponSpacer = $(<span class="string">"#J_coupon_spacer"</span>);</span><br><span class="line">    <span class="keyword">var</span> barHeight = $(<span class="string">"#J_page_bar"</span>).outerHeight();</span><br><span class="line">    brandTop = $brand.length &amp;&amp; $brand.offset().top &gt; <span class="number">0</span> ? ($brand.offset().top - (<span class="keyword">this</span>.isPageBrand ? barHeight : <span class="number">0</span>)) : <span class="number">0</span>;</span><br><span class="line">    couponTop = $couponSpacer.length ? $couponSpacer.offset().top - barHeight : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> relateTop = $relate.length &amp;&amp; $relate.offset().top &gt; <span class="number">0</span> ? <span class="keyword">this</span>.isBrandManji ? $relate.offset().top - (<span class="keyword">this</span>.isPageBrand ? (barHeight + $coupon.outerHeight() ) : (barHeight + $coupon.height() - <span class="built_in">parseFloat</span>(<span class="number">.3</span> * htmlFS))) : $relate.offset().top - barHeight : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> brandColH = <span class="keyword">this</span>.isBrandManji ? <span class="built_in">parseFloat</span>(<span class="number">2.6</span> * htmlFS) : <span class="built_in">parseFloat</span>(<span class="number">1.48</span> * htmlFS);</span><br><span class="line">    <span class="keyword">var</span> brandItemH = <span class="built_in">parseFloat</span>(<span class="number">3.18</span> * htmlFS);</span><br><span class="line">    <span class="keyword">var</span> n = brandTop + brandColH - $win.height();</span><br><span class="line">    <span class="keyword">var</span> inRelate = <span class="literal">false</span>,</span><br><span class="line">        pgCFixed = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> curTop = <span class="number">0</span>,</span><br><span class="line">        beTop = <span class="number">0</span>,</span><br><span class="line">        stand = <span class="number">0</span>;</span><br><span class="line">    that.manji = that.isBrandManji;</span><br><span class="line"></span><br><span class="line">    $win.on(<span class="string">'scroll.HUB'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        curTop = <span class="built_in">parseFloat</span>($win.scrollTop());</span><br><span class="line">        <span class="keyword">if</span> (curTop == <span class="number">0</span>) &#123; <span class="comment">// 显示更多悬浮 隐藏置顶悬浮 隐藏bar 隐藏优惠券 off监听</span></span><br><span class="line">            that.showMore = <span class="literal">true</span>;</span><br><span class="line">            that.goTopShow = <span class="literal">false</span>;</span><br><span class="line">            that.scroll = <span class="literal">false</span>;</span><br><span class="line">            $doc.off(<span class="string">"touchmove.HUB"</span>);</span><br><span class="line">            that.inBrand = <span class="literal">false</span>;</span><br><span class="line">            that.cfixed = <span class="literal">false</span>;</span><br><span class="line">            inRelate = <span class="literal">false</span>;</span><br><span class="line">            pgCFixed = <span class="literal">false</span>;</span><br><span class="line">            that.manji = that.isBrandManji;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (curTop &gt; <span class="number">0</span> &amp;&amp; ((brandTop &amp;&amp; curTop &lt; brandTop) || (!brandTop &amp;&amp; curTop &lt; relateTop))) &#123; <span class="comment">// 隐藏更多悬浮 隐藏置顶悬浮 隐藏bar 隐藏优惠券 off监听</span></span><br><span class="line">            that.showMore = <span class="literal">false</span>;</span><br><span class="line">            that.goTopShow = <span class="literal">false</span>;</span><br><span class="line">            that.scroll = <span class="literal">false</span>;</span><br><span class="line">            $doc.off(<span class="string">"touchmove.HUB"</span>);</span><br><span class="line">            that.inBrand = <span class="literal">false</span>;</span><br><span class="line">            that.cfixed = <span class="literal">false</span>;</span><br><span class="line">            inRelate = <span class="literal">false</span>;</span><br><span class="line">            pgCFixed = <span class="literal">false</span>;</span><br><span class="line">            that.manji = that.isBrandManji;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (brandTop &amp;&amp; curTop &gt; brandTop &amp;&amp; (relateTop &amp;&amp; curTop &lt; relateTop) || !relateTop) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!that.inBrand) &#123; <span class="comment">// inBrand 第一次 显示置顶悬浮 显示bar 显示优惠券</span></span><br><span class="line">                that.inBrand = <span class="literal">true</span>;</span><br><span class="line">                that.goTopShow = <span class="literal">true</span>;</span><br><span class="line">                that.showMore = <span class="literal">false</span>;</span><br><span class="line">                that.scroll = <span class="literal">true</span>;</span><br><span class="line">                inRelate = <span class="literal">false</span>;</span><br><span class="line">                pgCFixed = <span class="literal">false</span>;</span><br><span class="line">                that.manji = that.isBrandManji;</span><br><span class="line">                <span class="keyword">if</span> (that.isPageBrand) &#123;</span><br><span class="line">                    that.cfixed = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">if</span>(!pgCFixed &amp;&amp; curTop &gt;= couponTop) &#123;</span><br><span class="line">                        pgCFixed = <span class="literal">true</span>;</span><br><span class="line">                        that.cfixed = that.isBrandManji;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    that.cfixed = that.isBrandManji;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                that.barTitle = that.brandTitle;</span><br><span class="line">                <span class="keyword">if</span> (that.brandNum &gt; <span class="number">20</span>) &#123;</span><br><span class="line">                    stand = <span class="built_in">Math</span>.ceil((curTop - n) / brandItemH);</span><br><span class="line">                    that.divide = stand &gt; that.brandNum ? that.brandNum : stand;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// 向上/向下 计算滑动个数</span></span><br><span class="line">                <span class="keyword">if</span> (that.isPageBrand &amp;&amp; !pgCFixed &amp;&amp; curTop &gt;= couponTop) &#123;</span><br><span class="line">                    pgCFixed = <span class="literal">true</span>;</span><br><span class="line">                    that.cfixed = that.isBrandManji;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (pgCFixed &amp;&amp; curTop &lt; couponTop) &#123;</span><br><span class="line">                    that.cfixed = <span class="literal">false</span>;</span><br><span class="line">                    that.manji = that.isBrandManji;</span><br><span class="line">                    pgCFixed = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (curTop &lt; beTop &amp;&amp; that.down) &#123; <span class="comment">// 向上</span></span><br><span class="line">                    that.down = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (curTop &gt; beTop &amp;&amp; !that.down) &#123; <span class="comment">// 向下</span></span><br><span class="line">                    that.down = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                beTop = curTop;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (that.brandNum &gt; <span class="number">20</span>) &#123;</span><br><span class="line">                    stand = <span class="built_in">Math</span>.ceil((curTop - n) / brandItemH);</span><br><span class="line">                    that.divide = stand &gt; that.brandNum ? that.brandNum : stand;</span><br><span class="line">                    $doc.on(<span class="string">"touchmove.HUB"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        stand = <span class="built_in">Math</span>.ceil((curTop - n) / brandItemH);</span><br><span class="line">                        that.divide = stand &gt; that.brandNum ? that.brandNum : stand;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (relateTop &amp;&amp; curTop &gt; relateTop &amp;&amp; !inRelate) &#123; <span class="comment">// inRelate 隐藏优惠券 off监听</span></span><br><span class="line">            inRelate = <span class="literal">true</span>;</span><br><span class="line">            pgCFixed = <span class="literal">false</span>;</span><br><span class="line">            that.inBrand = <span class="literal">false</span>;</span><br><span class="line">            that.cfixed = <span class="literal">false</span>;</span><br><span class="line">            that.showMore = <span class="literal">false</span>;</span><br><span class="line">            that.goTopShow = <span class="literal">true</span>;</span><br><span class="line">            that.scroll = <span class="literal">true</span>;</span><br><span class="line">            that.manji = <span class="literal">false</span>;</span><br><span class="line">            $doc.off(<span class="string">"touchmove.HUB"</span>);</span><br><span class="line">            that.barTitle = <span class="string">"猜你喜欢"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g1ez9l6zw2j30c80c274o.jpg" alt=""></p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g1ez9nxix6j306c03kaa1.jpg" alt=""></p><h4 id="后期优化"><a href="#后期优化" class="headerlink" title="后期优化"></a>后期优化</h4><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g1ezax6t2wj30k0032mx5.jpg" alt=""></p><h5 id="优化scroll性能"><a href="#优化scroll性能" class="headerlink" title="优化scroll性能"></a>优化scroll性能</h5><ul><li>函数节流<ul><li>当持续触发事件时，debounce 会合并事件且不会去触发事件，当一定时间内没有触发再这个事件时，才真正去触发事件。</li><li>适用于多次提交（commit）的场景，如点击按钮提交发送请求的情况</li></ul></li><li><p>函数防抖</p><ul><li>持续触发事件时，throttle 会合并一定时间内的事件，并在该时间结束时真正去触发一次事件。</li><li>适用于scroll/resize等场景</li></ul></li><li><p>=&gt; 节流方案</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> didScroll = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    didScroll = <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( didScroll ) &#123;</span><br><span class="line">        didScroll = <span class="literal">false</span>;</span><br><span class="line">        fun();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">250</span>);</span><br></pre></td></tr></table></figure><h5 id="优化渲染方式"><a href="#优化渲染方式" class="headerlink" title="优化渲染方式"></a>优化渲染方式</h5><ul><li><p>当访问scrollWidth系列、clientHeight系列、offsetTop系列、ComputedStyle等属性时，会JS强制重排，导致Style和Layout前移到JS代码执行过程中</p></li><li><p>使用<code>requestAnimationFrame()</code>，将以上特殊操作汇集并延迟入队</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newScrollTop = <span class="keyword">this</span>.getPosition(<span class="keyword">this</span>.panes[index].$refs.content).top - <span class="keyword">this</span>.distance</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrollStep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.documentElement.scrollTop += <span class="number">5</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.documentElement.scrollTop &lt; newScrollTop) &#123;</span><br><span class="line">        <span class="built_in">window</span>.requestAnimationFrame(scrollStep)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.requestAnimationFrame(scrollStep);</span><br></pre></td></tr></table></figure><h5 id="做位移效果时使用tranform代替top-left-bottom-right"><a href="#做位移效果时使用tranform代替top-left-bottom-right" class="headerlink" title="做位移效果时使用tranform代替top/left/bottom/right"></a>做位移效果时使用tranform代替top/left/bottom/right</h5><ul><li><code>top/left/bottom/right</code>这类属性会影响元素在文档中的布局，可能改变其他元素的位置，引起重排，造成性能开销</li><li>使用<code>transform属性（3D/animation）</code>将元素提升至合成层，省去布局和绘制环节<ul><li><code>合成层</code>： 合成层的位图，会交由 GPU 合成，比 CPU 处理要快。当需要 repaint 时，只需要 repaint 本身，不会影响到其他的层。</li></ul></li></ul><h3 id="3-提醒组件"><a href="#3-提醒组件" class="headerlink" title="3. 提醒组件"></a>3. 提醒组件</h3><ul><li><code>static/super/src/h5/js/common/subscribe-jq.js</code></li></ul><p>增加callback</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> bindSub: <span class="function"><span class="keyword">function</span>(<span class="params">selector, spmSub, spmCancel, item</span>) </span>&#123;</span><br><span class="line">    Super.H5.Common.SubScribe(&#123;</span><br><span class="line">        triggerSelector: selector,</span><br><span class="line">        isNeedLogin: <span class="literal">true</span>,</span><br><span class="line">        isToast: <span class="literal">true</span>,</span><br><span class="line">        subsrcibeSelectorText: <span class="string">"提醒我"</span>,</span><br><span class="line">        toastSubsrcibedVal: <span class="string">"已取消提醒和收藏"</span>,</span><br><span class="line">        toastUnsubsrcibeVal: <span class="string">'已设置提醒并收藏成功'</span>,</span><br><span class="line">        subCallback: <span class="function"><span class="keyword">function</span>(<span class="params">itemId</span>) </span>&#123;</span><br><span class="line">            $.getJSON(ajaxAddSubUrl, &#123;</span><br><span class="line">                item_id: itemId,</span><br><span class="line">                t: <span class="keyword">new</span> <span class="built_in">Date</span>().getTime()</span><br><span class="line">            &#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                UBT.track(spmSub);</span><br><span class="line">                <span class="keyword">if</span> (item) &#123;</span><br><span class="line">                    Vue.set(item, <span class="string">'isSubscribe'</span>, <span class="literal">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        unSubCallback: <span class="function"><span class="keyword">function</span>(<span class="params">itemId</span>) </span>&#123;</span><br><span class="line">            $.getJSON(ajaxAddSubUrl, &#123;</span><br><span class="line">                item_id: itemId,</span><br><span class="line">                t: <span class="keyword">new</span> <span class="built_in">Date</span>().getTime()</span><br><span class="line">            &#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                UBT.track(spmCancel);</span><br><span class="line">                <span class="keyword">if</span> (item) &#123;</span><br><span class="line">                    Vue.set(item, <span class="string">'isSubscribe'</span>, <span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-iphoneX-1px边框问题-（若遇到相同问题，可进一步公用）"><a href="#4-iphoneX-1px边框问题-（若遇到相同问题，可进一步公用）" class="headerlink" title="4. iphoneX 1px边框问题 （若遇到相同问题，可进一步公用）"></a>4. iphoneX 1px边框问题 （若遇到相同问题，可进一步公用）</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*fl hairlines */</span></span><br><span class="line"><span class="selector-class">.fl-hairlines</span> <span class="selector-class">.border1px</span>&#123;<span class="attribute">border-width</span>:<span class="number">0.5px</span>;&#125;</span><br><span class="line"><span class="selector-class">.b1px</span> &#123; <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>; &#125;</span><br><span class="line"><span class="selector-class">.fl-hairlines</span> <span class="selector-class">.b1px</span> &#123; <span class="attribute">border-width</span>: <span class="number">0.7px</span>;&#125;</span><br><span class="line"> @<span class="keyword">media</span> all and (max-device-width:<span class="number">320px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.fl-hairlines</span><span class="selector-class">.fl-iphone</span> <span class="selector-class">.b1px</span> &#123;<span class="attribute">border-width</span>: <span class="number">0.5px</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>1px在用了hairlines能解决大部分，但在iphoneX的呈现上会出现<strong>上细下粗且有毛边</strong></p></li><li><p>当前解决方案：针对<code>iphonex</code>，去掉原有border，将border写为<code>:before</code>/<code>:after</code>定位在按钮上，当前测试border宽度宜为<code>.8px</code></p></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> only screen and (device-width:<span class="number">375px</span>) and (device-height:<span class="number">812px</span>) and (-webkit-device-pixel-ratio:<span class="number">3</span>) &#123;</span><br><span class="line"><span class="selector-class">.fl-hairlines</span><span class="selector-class">.fl-iphone</span> <span class="selector-class">.brand-list</span> <span class="selector-class">.btn</span><span class="selector-pseudo">:after</span> &#123; <span class="attribute">content</span>: <span class="string">""</span>; <span class="attribute">position</span>: absolute; <span class="attribute">top</span>: .<span class="number">8px</span>; <span class="attribute">left</span>: <span class="number">0</span>; <span class="attribute">width</span>: <span class="number">1.4rem</span>; <span class="attribute">height</span>: .<span class="number">5rem</span>; <span class="attribute">border</span>: .<span class="number">8px</span> solid <span class="number">#F10C10</span>; <span class="attribute">border-radius</span>: .<span class="number">25rem</span>; <span class="attribute">box-sizing</span>: border-box; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-iphoneX公用"><a href="#5-iphoneX公用" class="headerlink" title="5. iphoneX公用"></a>5. iphoneX公用</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">supports</span> (padding-bottom:constant(safe-area-inset-bottom))&#123;</span><br><span class="line">    <span class="selector-class">.nav-foot</span>&#123;<span class="attribute">padding-bottom</span>:<span class="built_in">constant</span>(safe-area-inset-bottom);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>static/webapp/js/common/attrsniffer.js</code></li><li><code>static/webapp/js/base.js</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">    html.classList.add(<span class="string">"fl-ios"</span>);</span><br><span class="line">    vArr = appv.match(<span class="regexp">/OS (\d+)[_\.](?:\d+)[_\.]?(?:\d+)?/</span>);</span><br><span class="line">    ver = <span class="built_in">parseInt</span>(vArr[<span class="number">1</span>], <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ver &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">        html.classList.add(<span class="string">"fl-hairlines"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ratio == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>( w = <span class="number">375</span> &amp;&amp; h == <span class="number">812</span>) &#123; <span class="comment">// iPhone X、iPhone XS</span></span><br><span class="line">            html.classList.add(<span class="string">"fl-ios-bangs"</span>, <span class="string">"fl-ios-x"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( w = <span class="number">414</span> &amp;&amp; h == <span class="number">896</span>) &#123; <span class="comment">// iPhone XS Max</span></span><br><span class="line">            html.classList.add(<span class="string">"fl-ios-bangs"</span>, <span class="string">"fl-ios-xmax"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ratio == <span class="number">2</span> &amp;&amp; w == <span class="number">414</span> &amp;&amp; h == <span class="number">896</span>) &#123;</span><br><span class="line">        html.classList.add(<span class="string">"fl-ios-bangs"</span>, <span class="string">"fl-ios-xr"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    vArr = appv;</span><br><span class="line">    ver = <span class="built_in">parseInt</span>(ua.substr(ua.indexOf(<span class="string">'android'</span>) + <span class="number">8</span>, <span class="number">3</span>));</span><br><span class="line">    html.classList.add(<span class="string">"fl-android"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (ver &lt; <span class="number">6</span>) &#123;</span><br><span class="line">        html.classList.add(<span class="string">"fl-android-"</span> + ver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iPhone X、iPhone XS</span></span><br><span class="line"><span class="string">"isIosX"</span>: <span class="regexp">/ip(hone|od|ad)/i</span>.test(navigator.userAgent.toLowerCase()) &amp;&amp; <span class="built_in">window</span>.devicePixelRatio === <span class="number">3</span> &amp;&amp; <span class="built_in">window</span>.screen.width === <span class="number">375</span> &amp;&amp; <span class="built_in">window</span>.screen.height === <span class="number">812</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// iPhone XS Max</span></span><br><span class="line"><span class="string">"isIosXMax"</span>: <span class="regexp">/ip(hone|od|ad)/i</span>.test(navigator.userAgent.toLowerCase()) &amp;&amp; <span class="built_in">window</span>.devicePixelRatio === <span class="number">3</span> &amp;&amp; <span class="built_in">window</span>.screen.width === <span class="number">414</span> &amp;&amp; <span class="built_in">window</span>.screen.height === <span class="number">896</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// iPhone XR</span></span><br><span class="line"><span class="string">"isIosXR"</span>: <span class="regexp">/ip(hone|od|ad)/i</span>.test(navigator.userAgent.toLowerCase()) &amp;&amp; <span class="built_in">window</span>.devicePixelRatio === <span class="number">2</span> &amp;&amp; <span class="built_in">window</span>.screen.width === <span class="number">414</span> &amp;&amp; <span class="built_in">window</span>.screen.height === <span class="number">896</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"isIosBangs"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Fanli.Utility.isIosX || Fanli.Utility.isIosXMax || Fanli.Utility.isIosXR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-圆角悬浮动效"><a href="#6-圆角悬浮动效" class="headerlink" title="6. 圆角悬浮动效"></a>6. 圆角悬浮动效</h3><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g119qw0ovgj30vt04576k.jpg" alt=""></p><p>ui想要的效果：</p><ul><li>边上滑边收圆角</li><li>页面从z轴分为三层：背景图层，页面滚动层，bar层</li></ul><p>实现：</p><ul><li>圆角：切出一行圆角png图</li><li>背景图做一个div background-image <code>z-index:-1;position:fixed;</code></li><li>bar层做一个div，限制高度，并且background: url(xxx) no-repeat top; 保证从视觉是bar层的背景图是一直在背景图层的</li><li>券层虽跟bar层在一个平面，但因为独立fixed，所以也加上background</li></ul><h3 id="7-skeleton骨架屏切换"><a href="#7-skeleton骨架屏切换" class="headerlink" title="7. skeleton骨架屏切换"></a>7. skeleton骨架屏切换</h3><ul><li>vue-router</li></ul><p><code>this.$route.name</code></p><ul><li>Fanli.Utility.getUrlParam(url, name)</li></ul><p><code>Fanli.Utility.getUrlParam(href, &#39;isbrand&#39;) == 1</code></p><h3 id="8-滚动加载-async-data"><a href="#8-滚动加载-async-data" class="headerlink" title="8. 滚动加载 async-data"></a>8. 滚动加载 async-data</h3><ul><li><code>static/super/src/h5/css/common/async-data.css</code></li><li><code>static/super/src/h5/js/common/async-data.vue.js</code></li></ul><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="项目总结" scheme="https://wangchloe.vip/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>vue小记</title>
    <link href="https://wangchloe.vip/2019/03/24/blog49/"/>
    <id>https://wangchloe.vip/2019/03/24/blog49/</id>
    <published>2019-03-24T06:39:21.000Z</published>
    <updated>2019-07-24T06:58:28.550Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><a id="more"></a><h3 id="v-html使用filter"><a href="#v-html使用filter" class="headerlink" title="v-html使用filter"></a>v-html使用filter</h3><p><code>v-html=&quot;$options.filters.highlight(option.title)&quot;</code></p><h3 id="销毁window-scroll"><a href="#销毁window-scroll" class="headerlink" title="销毁window.scroll"></a>销毁window.scroll</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mounted()&#123;</span><br><span class="line">   <span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, <span class="keyword">this</span>.scrollListener,<span class="literal">false</span>)</span><br><span class="line">&#125;,</span><br><span class="line">destroyed()&#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">'scroll'</span>,<span class="keyword">this</span>.scrollListener,<span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="vue" scheme="https://wangchloe.vip/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>数字速变特效</title>
    <link href="https://wangchloe.vip/2018/12/11/blog58/"/>
    <id>https://wangchloe.vip/2018/12/11/blog58/</id>
    <published>2018-12-11T09:12:06.000Z</published>
    <updated>2019-07-24T09:28:07.809Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><p>嚓嚓嚓 顿顿顿<br><a id="more"></a></p><p>效果如下</p><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g5b1ulk5ydg30hs08we6m.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">bindNumScroll: <span class="function"><span class="keyword">function</span>(<span class="params">val, initVal</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> current = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> step = val &gt;= <span class="number">400</span> ? <span class="built_in">Math</span>.ceil(val / <span class="number">100</span>) : <span class="built_in">Math</span>.ceil(val / <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">var</span> start = <span class="built_in">parseFloat</span>(initVal);</span><br><span class="line"></span><br><span class="line">    timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        start += step;</span><br><span class="line">        <span class="keyword">if</span> (start &gt; val) &#123;</span><br><span class="line">            clearInterval(timer);</span><br><span class="line">            start = val;</span><br><span class="line">            timer = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (current === start) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = start;</span><br><span class="line">        $numBounty.html(current.toString().replace(<span class="regexp">/(\d)(?=(?:\d&#123;3&#125;[+]?)+$)/g</span>, <span class="string">'$1,'</span>));</span><br><span class="line">    &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;嚓嚓嚓 顿顿顿&lt;br&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="js" scheme="https://wangchloe.vip/tags/js/"/>
    
      <category term="特效" scheme="https://wangchloe.vip/tags/%E7%89%B9%E6%95%88/"/>
    
  </entry>
  
  <entry>
    <title>nextTick研究报告</title>
    <link href="https://wangchloe.vip/2018/10/12/blog42/"/>
    <id>https://wangchloe.vip/2018/10/12/blog42/</id>
    <published>2018-10-11T19:27:35.000Z</published>
    <updated>2019-07-23T09:17:36.829Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><ul><li>nextTick<ul><li>es5源码</li><li>关于setTimeout(fn,0)</li></ul></li><li>讨论点</li><li>常用示例<ul><li>1.mounted时更新<ul><li>console</li></ul></li><li>2.更改子组件更新时间<ul><li>console</li></ul></li><li>3.同时更改父组件更新时间<ul><li>console</li></ul></li><li>4.nextTick顺序问题<ul><li>console</li></ul></li></ul></li><li>总结</li></ul><a id="more"></a><hr><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><p>在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。</p><blockquote><p>vue这么做是因为频繁的更新dom是特别耗费性能的，所以搞了一个批处理更新，把所有的update操作放到任务队列中，等主线程中执行栈的所有同步任务执行完毕，系统就会读取任务队列。</p></blockquote><h3 id="es5源码"><a href="#es5源码" class="headerlink" title="es5源码"></a>es5源码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Defer a task to execute it asynchronously.</span></span><br><span class="line"><span class="comment"> * 异步更新队列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> nextTick = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> callbacks = [];</span><br><span class="line">    <span class="keyword">var</span> pending = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> timerFunc;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">nextTickHandler</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        pending = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> copies = callbacks.slice(<span class="number">0</span>);</span><br><span class="line">        callbacks.length = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; copies.length; i++) &#123;</span><br><span class="line">            copies[i]();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只要观察到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据改变。</span></span><br><span class="line">    <span class="comment">// 如果同一个 watcher 被多次触发，只会被推入到队列中一次。</span></span><br><span class="line">    <span class="comment">// 这种在缓冲时去除重复数据对于避免不必要的计算和 DOM 操作上非常重要。</span></span><br><span class="line">    <span class="comment">// 然后，在下一个的事件循环“tick”中，Vue 刷新队列并执行实际 (已去重的) 工作。</span></span><br><span class="line">    <span class="comment">// Vue 在内部尝试对异步队列使用原生的 Promise.then 和 MessageChannel，如果执行环境不支持，会采用 setTimeout(fn, 0) 代替。</span></span><br><span class="line">    timerFunc = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        setTimeout(nextTickHandler, <span class="number">0</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">queueNextTick</span>(<span class="params">cb, ctx</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _resolve;</span><br><span class="line">        callbacks.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    cb.call(ctx);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                    handleError(e, ctx, <span class="string">'nextTick'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (_resolve) &#123;</span><br><span class="line">                _resolve(ctx);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">            pending = <span class="literal">true</span>;</span><br><span class="line">            timerFunc();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">Vue.prototype.$nextTick = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> nextTick(fn, <span class="keyword">this</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="关于setTimeout-fn-0"><a href="#关于setTimeout-fn-0" class="headerlink" title="关于setTimeout(fn,0)"></a>关于setTimeout(fn,0)</h3><p><a href="https://juejin.im/entry/58d4df3b5c497d0057eb99ff" target="_blank" rel="noopener">理解 JavaScript 中的 macrotask 和 microtask</a></p><blockquote><p> JavaScript 主线程拥有一个 <code>执行栈</code> 以及一个 <code>任务队列</code>，主线程会依次执行代码，当遇到函数时，会先将<code>函数 入栈</code>，函数运行完毕后再将该<code>函数 出栈</code>，直到所有代码执行完毕。</p></blockquote><ul><li>macrotasks: setTimeout, setInterval, setImmediate, I/O, UI rendering</li><li>microtasks: process.nextTick, Promises, Object.observe(废弃), MutationObserver</li></ul><blockquote><p>在每一次事件循环中，macrotask 只会提取一个执行，而 microtask 会一直提取，直到 microtasks 队列清空。</p></blockquote><h2 id="讨论点"><a href="#讨论点" class="headerlink" title="讨论点"></a>讨论点</h2><ul><li>父组件nextTick的触发在子组件DOM完成前还是完成后？</li></ul><h2 id="常用示例"><a href="#常用示例" class="headerlink" title="常用示例"></a>常用示例</h2><p><a href="https://codepen.io/WangChloe/pen/JmEbxb" target="_blank" rel="noopener">codepen示例</a></p><ul><li>DOM</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_app"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1-mounted时更新"><a href="#1-mounted时更新" class="headerlink" title="1.mounted时更新"></a>1.mounted时更新</h3><ul><li>父组件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#J_app"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            title: <span class="string">"父组件"</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// el被新创建的vm.$el替换，挂载到实例上</span></span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件mounted"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"父组件nextTick"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            that.title = <span class="string">"父组件更新"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件更新"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><ul><li>子组件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tpl = <span class="string">"&lt;h4&gt;&#123;&#123;subtitle&#125;&#125;&lt;/h4&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    Vue.component(<span class="string">'item'</span>, &#123;</span><br><span class="line">        data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                subtitle: <span class="string">"子组件"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        props: [],</span><br><span class="line">        template: tpl,</span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// el被新创建的vm.$el替换，挂载到实例上</span></span><br><span class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件mounted"</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"子组件nextTick"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            that.subtitle = <span class="string">"子组件更新"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件更新"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="console"><a href="#console" class="headerlink" title="console"></a>console</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">父组件beforeCreate</span><br><span class="line">父组件created</span><br><span class="line">父组件beforeMount</span><br><span class="line">子组件beforeCreate</span><br><span class="line">子组件created</span><br><span class="line">子组件beforeMount</span><br><span class="line">子组件mounted</span><br><span class="line">子组件更新</span><br><span class="line">当前页面content:子组件</span><br><span class="line">父组件mounted</span><br><span class="line">父组件更新</span><br><span class="line">当前页面content:父组件 子组件</span><br><span class="line">子组件nextTick</span><br><span class="line">当前页面content:子组件</span><br><span class="line">父组件beforeUpdate</span><br><span class="line">子组件beforeUpdate</span><br><span class="line">子组件updated</span><br><span class="line">父组件updated</span><br><span class="line">父组件nextTick</span><br><span class="line">当前页面content:父组件更新 子组件更新</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fw0xto1eidj30wn0a80t4.jpg" alt=""></p><blockquote><p>nextTick写在数据更改前不能拿到更新后的数据。</p></blockquote><h3 id="2-更改子组件更新时间"><a href="#2-更改子组件更新时间" class="headerlink" title="2.更改子组件更新时间"></a>2.更改子组件更新时间</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tpl = <span class="string">"&lt;h4&gt;&#123;&#123;subtitle&#125;&#125;&lt;/h4&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    Vue.component(<span class="string">'item'</span>, &#123;</span><br><span class="line">        data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                subtitle: <span class="string">"子组件"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        props: [],</span><br><span class="line">        template: tpl,</span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// el被新创建的vm.$el替换，挂载到实例上</span></span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件mounted"</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"子组件nextTick"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                that.subtitle = <span class="string">"子组件更新"</span>;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"子组件更新"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="console-1"><a href="#console-1" class="headerlink" title="console"></a>console</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">父组件beforeCreate</span><br><span class="line">父组件created</span><br><span class="line">父组件beforeMount</span><br><span class="line">子组件beforeCreate</span><br><span class="line">子组件created</span><br><span class="line">子组件beforeMount</span><br><span class="line">子组件mounted</span><br><span class="line">父组件mounted</span><br><span class="line">父组件更新</span><br><span class="line">当前页面content:父组件 子组件</span><br><span class="line">子组件nextTick</span><br><span class="line">当前页面content:子组件</span><br><span class="line">父组件nextTick</span><br><span class="line">当前页面content:父组件 子组件</span><br><span class="line">父组件beforeUpdate</span><br><span class="line">父组件updated</span><br><span class="line"></span><br><span class="line">子组件更新</span><br><span class="line">当前页面content:子组件</span><br><span class="line">子组件beforeUpdate</span><br><span class="line">子组件updated</span><br></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fw0xu13un4j30wn0b6jrs.jpg" alt=""></p><blockquote><p>若子组件在mounted即更新，子组件的update动作会在父组件的beforeUpdate之后updated之前执行。<br>反之则更新后子组件自己执行update，并且由于父组件nextTick写在数据更改之前，导致先执行父组件nextTick再执行父组件的update动作。</p></blockquote><h3 id="3-同时更改父组件更新时间"><a href="#3-同时更改父组件更新时间" class="headerlink" title="3.同时更改父组件更新时间"></a>3.同时更改父组件更新时间</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#J_app"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            title: <span class="string">"父组件"</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// el被新创建的vm.$el替换，挂载到实例上</span></span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件mounted"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"父组件nextTick"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                that.title = <span class="string">"父组件更新"</span>;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"父组件更新"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="console-2"><a href="#console-2" class="headerlink" title="console"></a>console</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">父组件beforeCreate</span><br><span class="line">父组件created</span><br><span class="line">父组件beforeMount</span><br><span class="line">子组件beforeCreate</span><br><span class="line">子组件created</span><br><span class="line">子组件beforeMount</span><br><span class="line">子组件mounted</span><br><span class="line">父组件mounted</span><br><span class="line">子组件nextTick</span><br><span class="line">当前页面content:子组件</span><br><span class="line">父组件nextTick</span><br><span class="line">当前页面content:父组件 子组件</span><br><span class="line"></span><br><span class="line">子组件更新</span><br><span class="line">当前页面content:子组件</span><br><span class="line">子组件beforeUpdate</span><br><span class="line">子组件updated</span><br><span class="line">父组件更新</span><br><span class="line">当前页面content:父组件 子组件更新</span><br><span class="line">父组件beforeUpdate</span><br><span class="line">父组件updated</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fw0y07buyqj30wn0b6mxk.jpg" alt=""></p><blockquote><p>若父、子组件的更新延时相同，则会各自执行各自的update动作，子组件优先。</p></blockquote><h3 id="4-nextTick顺序问题"><a href="#4-nextTick顺序问题" class="headerlink" title="4.nextTick顺序问题"></a>4.nextTick顺序问题</h3><p><strong>nextTick应写在数据更改后</strong></p><ul><li>父组件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#J_app"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            title: <span class="string">"父组件"</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// el被新创建的vm.$el替换，挂载到实例上</span></span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件mounted"</span>);</span><br><span class="line"></span><br><span class="line">            that.title = <span class="string">"父组件更新"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"父组件已更新"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"父组件nextTick"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><ul><li>子组件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tpl = <span class="string">"&lt;h4&gt;&#123;&#123;subtitle&#125;&#125;&lt;/h4&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    Vue.component(<span class="string">'item'</span>, &#123;</span><br><span class="line">        data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                subtitle: <span class="string">"子组件"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        props: [],</span><br><span class="line">        template: tpl,</span><br><span class="line">        beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例初始化之后</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeCreate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 实例创建完成之后被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件created"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 在挂载开始之前被调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeMount"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        beforeUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新时调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件beforeUpdate"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件updated"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件mounted"</span>)</span><br><span class="line"></span><br><span class="line">            that.subtitle = <span class="string">"子组件更新"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"子组件已更新"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"子组件nextTick"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"当前页面content:"</span> + that.$el.textContent);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="console-3"><a href="#console-3" class="headerlink" title="console"></a>console</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">父组件beforeCreate</span><br><span class="line">父组件created</span><br><span class="line">父组件beforeMount</span><br><span class="line">子组件beforeCreate</span><br><span class="line">子组件created</span><br><span class="line">子组件beforeMount</span><br><span class="line">子组件mounted</span><br><span class="line">子组件已更新</span><br><span class="line">当前页面content:子组件</span><br><span class="line">父组件mounted</span><br><span class="line">父组件已更新</span><br><span class="line">当前页面content:父组件 子组件</span><br><span class="line">父组件beforeUpdate</span><br><span class="line">子组件beforeUpdate</span><br><span class="line">子组件updated</span><br><span class="line">父组件updated</span><br><span class="line">子组件nextTick</span><br><span class="line">当前页面content:子组件更新</span><br><span class="line">父组件nextTick</span><br><span class="line">当前页面content:父组件更新 子组件更新</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fw0x1a7prjj30xh0b2mxj.jpg" alt=""></p><blockquote><p>如果子组件nextTick写在数据更改前，则会在父组件mouted之后beforeUpdate之前执行nextTick。实际应在updated之后执行nextTick，这样nextTick才能拿到最新的数据。</p></blockquote><ul><li>推荐在updated中执行$nextTick</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">updated: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 数据更新之后调用</span></span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"组件updated"</span>);</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"组件nextTick"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li><p>父组件nextTick的触发在<strong>子组件updated后</strong>。</p></li><li><p>若子组件在mounted即更新，子组件的update动作会在父组件的beforeUpdate之后updated之前执行。<strong>反之则更新后子组件自己执行update，不会影响父组件的nextTick</strong>。</p></li><li><p>若父、子组件的更新延时相同，则会各自执行各自的update动作，<strong>子组件优先</strong>。</p></li><li><p>nextTick都需写在各自<strong>组件的updated之后</strong>。</p></li></ul><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！</p><p>公众号不发文的时候推送一些我觉得好用的前端网站或者看到的一些问题的解决方案，也更便于大家交流，就酱。</p><p><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;nextTick&lt;ul&gt;
&lt;li&gt;es5源码&lt;/li&gt;
&lt;li&gt;关于setTimeout(fn,0)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;讨论点&lt;/li&gt;
&lt;li&gt;常用示例&lt;ul&gt;
&lt;li&gt;1.mounted时更新&lt;ul&gt;
&lt;li&gt;console&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;2.更改子组件更新时间&lt;ul&gt;
&lt;li&gt;console&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;3.同时更改父组件更新时间&lt;ul&gt;
&lt;li&gt;console&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;4.nextTick顺序问题&lt;ul&gt;
&lt;li&gt;console&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;总结&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="vue" scheme="https://wangchloe.vip/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>北京5日游攻略～</title>
    <link href="https://wangchloe.vip/2018/09/21/life2/"/>
    <id>https://wangchloe.vip/2018/09/21/life2/</id>
    <published>2018-09-20T19:12:48.000Z</published>
    <updated>2019-07-23T09:32:40.946Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>手绘导览图，侬晓得伐</p><a id="more"></a><p><a href="https://www.jianshu.com/p/1204cbd915be" target="_blank" rel="noopener">北京5日游攻略～</a></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;手绘导览图，侬晓得伐&lt;/p&gt;
    
    </summary>
    
      <category term="你好，陌生人" scheme="https://wangchloe.vip/categories/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E9%99%8C%E7%94%9F%E4%BA%BA/"/>
    
    
      <category term="爱旅游" scheme="https://wangchloe.vip/tags/%E7%88%B1%E6%97%85%E6%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>小厨教你做鸡蛋灌饼</title>
    <link href="https://wangchloe.vip/2018/03/29/life5/"/>
    <id>https://wangchloe.vip/2018/03/29/life5/</id>
    <published>2018-03-28T19:12:48.000Z</published>
    <updated>2019-07-23T09:24:10.278Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p><strong>公众号又开新功能了，所以我又发了篇做饭教程，这次是老汪鸡蛋灌饼🥚！</strong></p><a id="more"></a><hr><p><a href="https://www.jianshu.com/p/ee03cef7fd7a" target="_blank" rel="noopener">无媛无故-小厨教你做鸡蛋灌饼</a></p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;公众号又开新功能了，所以我又发了篇做饭教程，这次是老汪鸡蛋灌饼🥚！&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="你好，陌生人" scheme="https://wangchloe.vip/categories/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E9%99%8C%E7%94%9F%E4%BA%BA/"/>
    
    
      <category term="爱做饭" scheme="https://wangchloe.vip/tags/%E7%88%B1%E5%81%9A%E9%A5%AD/"/>
    
  </entry>
  
  <entry>
    <title>九宫格转盘特效</title>
    <link href="https://wangchloe.vip/2018/03/09/blog59/"/>
    <id>https://wangchloe.vip/2018/03/09/blog59/</id>
    <published>2018-03-09T09:26:12.000Z</published>
    <updated>2019-07-24T09:31:52.738Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><p> duang duang duang</p><a id="more"></a><p>效果如下</p><p><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g5b26rryxyg30dg0jux6y.gif" alt=""></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"turntable"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"description"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>SquaredLotteryRoll<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-container table-container-1"</span> <span class="attr">id</span>=<span class="string">"J_lottery_container_1"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>- 九宫格<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-0"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-1"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-2"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-7"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-wrap"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_btn_start_1"</span>&gt;</span>点击抽奖<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-3"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-6"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-5"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-4"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-container table-container-2"</span> <span class="attr">id</span>=<span class="string">"J_lottery_container_2"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>- 十二宫格<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-0"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-1"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-2"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-3"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-11"</span>"&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-wrap"</span> <span class="attr">colspan</span>=<span class="string">"2"</span> <span class="attr">rowspan</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_btn_start_2"</span>&gt;</span>点击抽奖<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-4"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-10"</span>"&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-5"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-9"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-8"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-7"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"lottery-unit lottery-unit-6"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 排序为左上0 右上2 右下4 左下6</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        $.squaredLotteryRoll(&#123;</span></span><br><span class="line"><span class="javascript">            rollWrapSelector: <span class="string">"#J_lottery_container_1"</span>,</span></span><br><span class="line"><span class="javascript">            prizeIndex: <span class="number">1</span>, <span class="comment">// 中奖序号从0开始 1为row1 col2</span></span></span><br><span class="line"><span class="javascript">            isDefaultClickFn: <span class="literal">true</span>,  <span class="comment">// 默认点击事件</span></span></span><br><span class="line"><span class="javascript">            rollBtnSelector: <span class="string">"#J_btn_start_1"</span>,</span></span><br><span class="line"><span class="javascript">            succCallback: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">"抽奖成功"</span>);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        $(<span class="string">"#J_btn_start_2"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">"#J_lottery_container_2"</span>).addClass(<span class="string">"mode-2"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            $.squaredLotteryRoll(&#123;</span></span><br><span class="line"><span class="javascript">                rollWrapSelector: <span class="string">"#J_lottery_container_2"</span>,</span></span><br><span class="line"><span class="undefined">                prizeIndex: 6,</span></span><br><span class="line"><span class="javascript">                isDefaultClickFn: <span class="literal">false</span>,  <span class="comment">// 自定义点击事件</span></span></span><br><span class="line"><span class="undefined">            &#125;)</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    &#125;)();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///&lt;reference path="../vendors/jquery/jquery.js" /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file squaredLotteryRoll</span></span><br><span class="line"><span class="comment"> * @import vendors/jquery/jquery-2.1.1.js</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">##参数</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 九宫格转盘</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">    $.extend(&#123;</span><br><span class="line">        squaredLotteryRoll: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>, &#123;&#125;, &#123;</span><br><span class="line">                speed: <span class="number">200</span>, <span class="comment">//初始转动速度</span></span><br><span class="line">                times: <span class="number">0</span>, <span class="comment">//转动次数</span></span><br><span class="line">                cycle: <span class="number">50</span>, <span class="comment">//转动基本次数：即至少需要转动多少次再进入抽奖环节</span></span><br><span class="line">                prizeIndex: <span class="number">-1</span>, <span class="comment">//中奖位置</span></span><br><span class="line">                actClass: <span class="string">'act'</span>, <span class="comment">// 选中添加样式</span></span><br><span class="line">                unitSelector: <span class="string">".lottery-unit"</span>, <span class="comment">// 每个单元格的类名及索引前缀</span></span><br><span class="line">                rollWrapSelector: <span class="string">"#J_lottery_roll"</span>, <span class="comment">// 转盘</span></span><br><span class="line">                rollBtnSelector: <span class="string">"#J_btn_start"</span>, <span class="comment">// 抽奖按钮</span></span><br><span class="line">                isDefaultClickFn: <span class="literal">true</span>,</span><br><span class="line">                succCallback: $.noop,</span><br><span class="line">            &#125;, options);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> $rollWrap = $(settings.rollWrapSelector);</span><br><span class="line">            <span class="keyword">var</span> $rollBtn = $(settings.rollBtnSelector, settings.rollWrapSelector);</span><br><span class="line">            <span class="keyword">var</span> $units = $(settings.unitSelector, settings.rollWrapSelector);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> count = <span class="number">0</span>; <span class="comment">//总共有多少个位置</span></span><br><span class="line">            <span class="keyword">var</span> index = <span class="number">0</span>; <span class="comment">//当前转动到哪个位置</span></span><br><span class="line">            <span class="keyword">var</span> timer = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> click = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">var</span> times = settings.times;</span><br><span class="line">            <span class="keyword">var</span> speed = settings.speed;</span><br><span class="line">            <span class="keyword">var</span> prizeIndex = settings.prizeIndex &gt;= <span class="number">0</span> ? settings.prizeIndex : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> timer;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (!$rollWrap.length) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                settings.isDefaultClickFn ? initClick() : init();;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">initClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                $rollBtn.on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">                    ev.preventDefault();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (click) &#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    init();</span><br><span class="line">                    click = <span class="literal">true</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> len = $units.length;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (len &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    index = len - <span class="number">1</span>;</span><br><span class="line">                    $rollWrap.find(settings.unitSelector + <span class="string">"-"</span> + index).addClass(settings.actClass);</span><br><span class="line">                    count = $units.length;</span><br><span class="line">                    roll();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">roll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                times++;</span><br><span class="line">                rolling();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (times &gt; settings.cycle + <span class="number">10</span> &amp;&amp; prizeIndex == index) &#123;</span><br><span class="line">                    clearTimeout(timer);</span><br><span class="line">                    times = <span class="number">0</span>;</span><br><span class="line">                    click = <span class="literal">false</span>;</span><br><span class="line">                    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                        settings.succCallback &amp;&amp; settings.succCallback();</span><br><span class="line">                    &#125;, <span class="number">200</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (times &lt; settings.cycle) &#123;</span><br><span class="line">                        speed -= <span class="number">10</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (times &gt; settings.cycle + <span class="number">10</span> &amp;&amp; (prizeIndex == <span class="number">0</span> &amp;&amp; index == (count - <span class="number">1</span>)) || (prizeIndex == index + <span class="number">1</span>)) &#123;</span><br><span class="line">                            speed += <span class="number">110</span>;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            speed += <span class="number">20</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    speed &lt; <span class="number">40</span> &amp;&amp; (speed = <span class="number">40</span>);</span><br><span class="line">                    timer = setTimeout(roll, speed);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">rolling</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                $rollWrap.find(settings.unitSelector + <span class="string">"-"</span> + index).removeClass(settings.actClass);</span><br><span class="line">                index++;</span><br><span class="line">                <span class="keyword">if</span> (index &gt; count - <span class="number">1</span>) &#123;</span><br><span class="line">                    index = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                $rollWrap.find(settings.unitSelector + <span class="string">"-"</span> + index).addClass(settings.actClass);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            setup();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;(jQuery));</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt; duang duang duang&lt;/p&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="js" scheme="https://wangchloe.vip/tags/js/"/>
    
      <category term="特效" scheme="https://wangchloe.vip/tags/%E7%89%B9%E6%95%88/"/>
    
  </entry>
  
  <entry>
    <title>2017-D2前端技术论坛 新思</title>
    <link href="https://wangchloe.vip/2018/01/02/blog41/"/>
    <id>https://wangchloe.vip/2018/01/02/blog41/</id>
    <published>2018-01-01T19:27:35.000Z</published>
    <updated>2019-07-23T09:17:37.857Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><ul><li>天猫超市Mobile Web的极致体验优化<ul><li>回归web解决问题</li><li>web目前的不足</li><li>解决方向</li></ul></li></ul><a id="more"></a><hr><ul><li><a href="http://d2forum.alibaba-inc.com/#/index?_k=ux8vkk" target="_blank" rel="noopener">2017-D2</a></li></ul><blockquote><p><strong>匠心</strong> -&gt; <code>工匠精神</code> <code>简单的事做好</code> <code>简单的事做的更好</code></p></blockquote><h2 id="天猫超市Mobile-Web的极致体验优化"><a href="#天猫超市Mobile-Web的极致体验优化" class="headerlink" title="天猫超市Mobile Web的极致体验优化"></a>天猫超市Mobile Web的极致体验优化</h2><ul><li><a href="https://chaoshi.m.tmall.com/" target="_blank" rel="noopener">天猫超市</a></li></ul><h3 id="回归web解决问题："><a href="#回归web解决问题：" class="headerlink" title="回归web解决问题："></a>回归web解决问题：</h3><ul><li>滚动过程代码冻结(Native解决)<ul><li>WKWebview(ios8+) 替代 UIWebview组件<ul><li>在性能、稳定性、功能方面有很大提升<br>（最直观的体现就是加载网页是占用的内存，模拟器加载百度与开源中国网站时，WKWebView占用23M，而UIWebView占用85M）</li><li>允许JavaScript的Nitro引擎库加载并使用（UIWebView中限制）</li><li>支持了更多的HTML5特性</li><li>高达60fps的滚动刷新率以及内置手势</li><li>将UIWebViewDelegate与UIWebView重构成了14类与3个协议</li></ul></li><li>浏览器内核U4<ul><li>极速引擎，采用全新的V8引擎，在U4 1.0的基础上，性能继续提高10%，重新打开网页的速度提高10%-20%；</li><li>全新的渲染架构，新的Passive Event Listener、Intersection Observer等能力赋予H5页面更加流畅的操作体验；</li><li>标准领先，新内核支持最新的PWA技术以及其他最新的H5、JS、CSS标准，并在国内首次提供标准Web推送服务；</li><li>创新扩展，推出业界效率最高的Web AR技术，兼顾Native的体验和H5的高效率，还有其他更多的创新扩展值得期待。</li></ul></li></ul></li><li>加载慢<ul><li>预加载</li></ul></li><li>页头无法定制<ul><li>隐藏native页头，使用h5页头</li></ul></li></ul><h3 id="web目前的不足"><a href="#web目前的不足" class="headerlink" title="web目前的不足"></a>web目前的不足</h3><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fmumfdhjmmj315k09sjv1.jpg" alt="web目前的不足"></p><h3 id="解决方向"><a href="#解决方向" class="headerlink" title="解决方向"></a>解决方向</h3><h4 id="精细化"><a href="#精细化" class="headerlink" title="精细化"></a>精细化</h4><ul><li>还原度</li><li>字行高</li><li>Android文字垂直居中<ul><li>非miui下都是偏上的<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:-webkit-box;</span><br><span class="line">    <span class="attribute">display</span>:flex;</span><br><span class="line">    <span class="attribute">-webkit-box-pack</span>:center; <span class="comment">/*水平居中*/</span></span><br><span class="line">    <span class="attribute">-webkit-box-align</span>:center; <span class="comment">/*垂直居中*/</span></span><br><span class="line">    <span class="attribute">align-items</span>:center; <span class="comment">/*垂直居中*/</span></span><br><span class="line">    <span class="attribute">justify-content</span>:center; <span class="comment">/*水平居中*/</span></span><br><span class="line">    <span class="attribute">width</span>:<span class="number">2rem</span>;</span><br><span class="line">    <span class="attribute">height</span>:.<span class="number">3rem</span>;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">font-size</span>:.<span class="number">24rem</span>;</span><br><span class="line">    <span class="attribute">overflow</span>:hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="操作体验"><a href="#操作体验" class="headerlink" title="操作体验"></a>操作体验</h4><ul><li>极速响应 100ms内响应用户操作<ul><li>并行加载资源和数据 <strong>Promise.all()</strong></li><li>足够快时不需要loading<br><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fmvc87pt71j31660t6qfn.jpg" alt="足够快时不需要loading"></li></ul></li><li>实时反馈<ul><li>切换tabview时下边框线实时响应手势过程</li></ul></li><li><p>操作流畅</p><ul><li>动画<ul><li>只使用<strong>transform 3D/opacity</strong></li><li>适时使用<strong>will-change</strong>  <code>will-change:transform; /*创建新的渲染层*/</code> <ul><li><a href="http://blog.csdn.net/caicaijingyuan/article/details/44244991" target="_blank" rel="noopener">-webkit-transform:translate3d(0,0,0)触发GPU加速，让网页动画更流畅</a></li><li><a href="http://www.zhangxinxu.com/wordpress/2015/11/css3-will-change-improve-paint/" target="_blank" rel="noopener">使用CSS3 will-change提高页面滚动、动画等渲染性能</a><br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fms39ippvyj31ia0cmtdi.jpg" alt="translate3d &amp; will-change"></li></ul></li></ul></li><li><p>滚动</p><ul><li><p>必须使用<strong>passive event listeners</strong></p><blockquote><p>由于浏览器无法预先知道一个事件处理函数中会不会调用 preventDefault()，它需要等到事件处理函数执行完后，才能去执行默认行为，若监听完后再执行默认行为会导致页面卡顿。</p></blockquote><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fmundaoz61j3132072q65.jpg" alt="passive event listeners"></p><ul><li>我们可以通过传递 passive 为 true 来明确告诉浏览器，事件处理程序不会调用 preventDefault 来阻止默认滑动行为。</li><li><a href="https://segmentfault.com/a/1190000007913386?_ea=1507605" target="_blank" rel="noopener">移动Web滚动性能优化: Passive event listeners</a></li><li>Chrome 51 和 Firefox 49 已经支持 passive 属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> supportsPassive = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> opts = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'passive'</span>, &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      supportsPassive = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">window</span>.addEventListener(<span class="string">"test"</span>, <span class="literal">null</span>, opts);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">elem.addEventListener(</span><br><span class="line">  <span class="string">'touchstart'</span>,</span><br><span class="line">  fn,</span><br><span class="line">  supportsPassive ? &#123; <span class="attr">passive</span>: <span class="literal">true</span> &#125; : <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul></li></ul></li><li><p>手势</p><ul><li>配合使用touchmove &amp; scroll 事件<blockquote><p>ios第一次触发scroll存在延时，应配合使用touchmove</p></blockquote></li></ul></li></ul></li></ul><h4 id="可靠性"><a href="#可靠性" class="headerlink" title="可靠性"></a>可靠性</h4><ul><li><p>预加载</p><ul><li><p>service worker实现离线页面访问<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fmuo9a47zpj312w0lsdjk.jpg" alt="service worker push"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册 service worker</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">    navigator.serviceWorker.register(<span class="string">'./service-worker.js'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">registration</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 注册成功</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ServiceWorker registration successful with scope: '</span>, registration.scope);</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 注册失败</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ServiceWorker registration failed: '</span>, err);</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cacheVersion = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> currentCache = &#123;</span><br><span class="line">  offline: <span class="string">'offline-cache'</span> + cacheVersion</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> offlineUrl = <span class="string">'offline.html'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首次缓存</span></span><br><span class="line"><span class="keyword">this</span>.addEventListener(<span class="string">'install'</span>, event =&gt; &#123;</span><br><span class="line">  event.waitUntil(</span><br><span class="line">    caches.open(currentCache.offline).then(<span class="function"><span class="keyword">function</span>(<span class="params">cache</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> cache.addAll([</span><br><span class="line">          <span class="string">'./offline.svg'</span>,</span><br><span class="line">          offlineUrl</span><br><span class="line">      ]);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截请求</span></span><br><span class="line"><span class="keyword">this</span>.addEventListener(<span class="string">'fetch'</span>, event =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (event.request.mode === <span class="string">'navigate'</span> || (event.request.method === <span class="string">'GET'</span> &amp;&amp; event.request.headers.get(<span class="string">'accept'</span>).includes(<span class="string">'text/html'</span>))) &#123;</span><br><span class="line">        event.respondWith(</span><br><span class="line">          fetch(event.request.url).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// Return the offline page</span></span><br><span class="line">              <span class="keyword">return</span> caches.match(offlineUrl);</span><br><span class="line">        &#125;)</span><br><span class="line">     );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">        event.respondWith(caches.match(event.request)</span><br><span class="line">                        .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> response || fetch(event.request);</span><br><span class="line">                    &#125;)</span><br><span class="line">            );</span><br><span class="line">      &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul></li></ul><pre><code>![service workder兼容性](https://ws2.sinaimg.cn/large/006tKfTcly1fmvb3ae3whj31ae0g277h.jpg)</code></pre><h4 id="设计语言APP化"><a href="#设计语言APP化" class="headerlink" title="设计语言APP化"></a>设计语言APP化</h4><ul><li>无闪烁tabbar<br><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fmunohp8a1j316w0lg1kx.jpg" alt="设计语言APP化"></li></ul><blockquote><p>PS:同行者</p><ul><li>业务线庞大</li><li>技术纬度不同</li></ul></blockquote><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！</p><p>公众号不发文的时候推送一些我觉得好用的前端网站或者看到的一些问题的解决方案，也更便于大家交流，就酱。</p><p><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;天猫超市Mobile Web的极致体验优化&lt;ul&gt;
&lt;li&gt;回归web解决问题&lt;/li&gt;
&lt;li&gt;web目前的不足&lt;/li&gt;
&lt;li&gt;解决方向&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="前端论坛" scheme="https://wangchloe.vip/tags/%E5%89%8D%E7%AB%AF%E8%AE%BA%E5%9D%9B/"/>
    
  </entry>
  
  <entry>
    <title>css规范对比</title>
    <link href="https://wangchloe.vip/2017/10/10/blog57/"/>
    <id>https://wangchloe.vip/2017/10/10/blog57/</id>
    <published>2017-10-10T09:05:46.000Z</published>
    <updated>2017-10-10T09:05:46.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><!-- MarkdownTOC --><ul><li>连字符分隔</li><li>OOCSS</li><li>NEC<ul><li>区分</li><li>示例</li></ul></li><li>BEM<ul><li>区分</li><li>连接</li><li>示例</li><li>痛点</li></ul></li></ul><!-- /MarkdownTOC --><a id="more"></a><h2 id="连字符分隔"><a href="#连字符分隔" class="headerlink" title="连字符分隔"></a>连字符分隔</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"card-header-ul"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"card-header-li"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"card-header-p"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-footer"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="OOCSS"><a href="#OOCSS" class="headerlink" title="OOCSS"></a>OOCSS</h2><p><a href="http://oocss.org/" target="_blank" rel="noopener">Object Oriented CSS  面向对象的CSS</a></p><blockquote><p>结构和样式分离</p></blockquote><p>需求：有一个容器是页面page的1/4宽，有一个蓝色的背景，1px灰色的边框，10px的左右边距，5px的上边距，10px的下边距</p><ul><li>非OOCSS写法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"size1of4"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.size1of4</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: blue;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>OOCSS写法<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"size1of4 bgBlue solidGray mts mlm mrm mbm"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.size1of4</span> &#123;<span class="attribute">width</span>: <span class="number">25%</span>;&#125;</span><br><span class="line"><span class="selector-class">.bgBlue</span> &#123;<span class="attribute">background</span>:blue&#125;</span><br><span class="line"><span class="selector-class">.solidGray</span> &#123;<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>&#125;</span><br><span class="line"><span class="selector-class">.mts</span> &#123;<span class="attribute">margin-top</span>: <span class="number">5px</span>&#125;</span><br><span class="line"><span class="selector-class">.mrm</span> &#123;<span class="attribute">margin-right</span>: <span class="number">10px</span>&#125;</span><br><span class="line"><span class="selector-class">.mbm</span> &#123;<span class="attribute">margin-bottom</span>: <span class="number">10px</span>&#125;</span><br><span class="line"><span class="selector-class">.mlm</span> &#123;<span class="attribute">margin-left</span>: <span class="number">10px</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="NEC"><a href="#NEC" class="headerlink" title="NEC"></a>NEC</h2><p><a href="http://nec.netease.com/standard/css-sort.html" target="_blank" rel="noopener">nice easy css官网</a></p><h4 id="区分"><a href="#区分" class="headerlink" title="区分"></a>区分</h4><ul><li><p>布局（grid）<code>.g-</code>： eg:头部，尾部，主体，侧栏等</p></li><li><p>模块（module）<code>.m-</code>： 较大整体，eg:导航、登录注册、搜索等</p></li><li><p>元件（unit）<code>.u-</code>： 不可再分个体，eg:按钮、input框等</p></li><li><p>功能（function）<code>.f-</code>： 使用频率较高样式，eg:清除浮动</p></li><li><p>皮肤（skin）<code>.s-</code>： eg:文字色，背景色，边框色等</p></li><li><p>状态<code>.z-</code>： eg:hover，选中等</p></li><li><p>特殊<code>.j-</code>： 被专用于JS获取节点，请勿使用.j-定义样式。</p></li></ul><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p><a href="http://yuedu.163.com/" target="_blank" rel="noopener">网易云阅读</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 布局 */</span></span><br><span class="line"><span class="selector-class">.g-sd</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 模块 */</span></span><br><span class="line"><span class="selector-class">.m-logo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.m-logo</span> <span class="selector-class">.u-sel</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.m-logo</span><span class="selector-class">.z-dis</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 元件 */</span></span><br><span class="line"><span class="selector-class">.u-btn</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 统一清除浮动 */</span></span><br><span class="line"><span class="selector-class">.f-clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 功能 */</span></span><br><span class="line"><span class="selector-class">.f-tac</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 皮肤 */</span></span><br><span class="line"><span class="selector-class">.s-fc</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BEM"><a href="#BEM" class="headerlink" title="BEM"></a>BEM</h2><p><a href="http://getbem.com/naming/" target="_blank" rel="noopener">BEM官网</a></p><h4 id="区分-1"><a href="#区分-1" class="headerlink" title="区分"></a>区分</h4><ul><li><code>B</code> 块（block）</li><li><code>E</code> 元素（element）</li><li><code>M</code> 修饰符（modifier）</li></ul><p><img src="http://www.w3cplus.com/sites/default/files/styles/print_image/public/blogs/2013/Definitions-BEM-6.jpg" alt=""></p><h4 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h4><ul><li><p><code>__</code>双下划线： 间隔 块和元素</p><ul><li><code>.block__elem</code></li></ul></li><li><p><code>-</code>中划线： 间隔块、元素、修饰符中多个单词</p><ul><li><code>.block-name__elem-name</code></li><li><code>.block-name--modifier-modifier1</code></li></ul></li><li><p><code>--</code>双中划线： 间隔 块和修饰符 或 元素和修饰符</p><ul><li><code>.block__elem--modifier</code></li></ul></li></ul><h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><ul><li>B嵌套E</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card__header"</span>&gt;</span></span><br><span class="line">    123</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>B多层嵌套E</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card__header"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"card__header__ul"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"card__header__li"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"card__header__p"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">&amp;__header &#123;</span><br><span class="line">&amp;__ul &#123;</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">&amp;__li &#123;</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">&amp;__p &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>M修饰B/E</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card card--red"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card__header card__header--blue"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"button"</span>&gt;</span></span><br><span class="line">Normal button</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"button button--state-success"</span>&gt;</span></span><br><span class="line">Success button</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"button button--state-danger"</span>&gt;</span></span><br><span class="line">Danger button</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="痛点"><a href="#痛点" class="headerlink" title="痛点"></a>痛点</h4><ul><li>命名较长</li><li>会存在修饰符下的元素结构不清晰</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">.&amp;__header &#123;</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">&amp;__<span class="selector-tag">red</span> &#123;</span><br><span class="line">.card_header &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;!-- MarkdownTOC --&gt;
&lt;ul&gt;
&lt;li&gt;连字符分隔&lt;/li&gt;
&lt;li&gt;OOCSS&lt;/li&gt;
&lt;li&gt;NEC&lt;ul&gt;
&lt;li&gt;区分&lt;/li&gt;
&lt;li&gt;示例&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;BEM&lt;ul&gt;
&lt;li&gt;区分&lt;/li&gt;
&lt;li&gt;连接&lt;/li&gt;
&lt;li&gt;示例&lt;/li&gt;
&lt;li&gt;痛点&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="css" scheme="https://wangchloe.vip/tags/css/"/>
    
      <category term="规范" scheme="https://wangchloe.vip/tags/%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>两种原生组件书写方式</title>
    <link href="https://wangchloe.vip/2017/09/24/blog54/"/>
    <id>https://wangchloe.vip/2017/09/24/blog54/</id>
    <published>2017-09-24T07:23:37.000Z</published>
    <updated>2017-09-24T07:23:37.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><!-- MarkdownTOC --><ul><li>第一种：引用执行</li><li>第二种：将命名空间传递进</li></ul><!-- /MarkdownTOC --><a id="more"></a><blockquote><p>跨页面，对元素依赖不确定，使用命名空间阻断法传递元素</p></blockquote><h3 id="第一种：引用执行"><a href="#第一种：引用执行" class="headerlink" title="第一种：引用执行"></a>第一种：引用执行</h3><p>//webapp/js/common/topoverlay.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">w</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> FLNS = &#123;</span><br><span class="line">        <span class="string">"register"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> a = <span class="built_in">arguments</span>,</span><br><span class="line">                o = <span class="literal">null</span>,</span><br><span class="line">                i, j, d, rt;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; a.length; ++i) &#123;</span><br><span class="line">                d = a[i].split(<span class="string">"."</span>);</span><br><span class="line">                rt = d[<span class="number">0</span>];</span><br><span class="line">                <span class="built_in">eval</span>(<span class="string">'if (typeof '</span> + rt + <span class="string">' == "undefined")&#123;'</span> + rt + <span class="string">' = &#123;add: function (k, v) &#123; if (!this[k]) &#123; this[k] = v;&#125; return this;&#125; &#125;;&#125; o = '</span> + rt + <span class="string">';'</span>);</span><br><span class="line">                <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; d.length; ++j) &#123;</span><br><span class="line">                    o[d[j]] = o[d[j]] || &#123;&#125;;</span><br><span class="line">                    o = o[d[j]];</span><br><span class="line">                    o.add = <span class="function"><span class="keyword">function</span>(<span class="params">k, v</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="keyword">this</span>[k]) &#123; <span class="keyword">this</span>[k] = v; &#125;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    w.FLNS = FLNS;</span><br><span class="line"></span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br><span class="line"></span><br><span class="line">FLNS.register(<span class="string">"NS"</span>).add(<span class="string">"open"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>, &#123;&#125;, &#123;</span><br><span class="line">        image: &#123;</span><br><span class="line">            ios: <span class="string">"xxx.png"</span>,</span><br><span class="line">            android: <span class="string">"yyy.png"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, options);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> elSelector = <span class="string">"#J_weixin_browser"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">document</span>.querySelector(elSelector)) &#123;</span><br><span class="line">            buildOverlay();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            showOverlay();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">showOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.querySelector(elSelector).style.display = <span class="string">"block"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hideOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.querySelector(elSelector).style.display = <span class="string">"none"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">buildOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// code here</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setup();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">// 微信引导浮层</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickBrowser</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $btnBrowser.click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        NS.open(&#123;</span><br><span class="line">            image: &#123;</span><br><span class="line">                ios: <span class="string">"zzz.png"</span>,</span><br><span class="line">                android: <span class="string">"www.png"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="第二种：将命名空间传递进"><a href="#第二种：将命名空间传递进" class="headerlink" title="第二种：将命名空间传递进"></a>第二种：将命名空间传递进</h3><p>//super/src/h5/js/wechat/topoverlay.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">MODULE</span>) </span>&#123;</span><br><span class="line">    MODULE.add(<span class="string">"TopOverlay"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>, &#123;&#125;, &#123;</span><br><span class="line">            autoShow: <span class="literal">false</span>,</span><br><span class="line">            showDownload: <span class="literal">true</span>,</span><br><span class="line">            image: &#123;</span><br><span class="line">                ios: <span class="string">"xxx.png"</span>,</span><br><span class="line">                android: <span class="string">"yyy.png"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, options);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> $<span class="built_in">window</span> = $(<span class="built_in">window</span>);</span><br><span class="line">        <span class="keyword">var</span> $<span class="built_in">document</span> = $(<span class="built_in">document</span>);</span><br><span class="line">        <span class="keyword">var</span> isFromWeixin = wagv &amp;&amp; wagv.isFromWeixin;</span><br><span class="line">        <span class="keyword">var</span> isIos = !!navigator.userAgent.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> OLSB = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">var</span> topoverlaySelector = <span class="string">"#J_wechat_topoverlay"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">buildOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> imgSrc = isIos ? settings.image.ios : settings.image.android;</span><br><span class="line">             <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindAutoShow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (settings.autoShow) &#123;</span><br><span class="line">                showOverlay();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindLiveEvent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $<span class="built_in">document</span>.on(<span class="string">"click"</span>, <span class="string">"&#123;0&#125; .J_close"</span>.format(topoverlaySelector), <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                hideOverlay();</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            $<span class="built_in">document</span>.on(<span class="string">"click"</span>, <span class="string">"a"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> $current = $(<span class="keyword">this</span>);</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    1. a </span></span><br><span class="line"><span class="comment">                    2. a data-superlink="" href="javascript:void(0);" 有个动态跳转</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    鉴于第2点，有优先级关系，将data-superlink嗅探提前</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">var</span> href = $current.attr(<span class="string">"data-superlink"</span>) || $current.attr(<span class="string">"data-href"</span>) || $current.attr(<span class="string">"href"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!href) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (href.indexOf(<span class="string">"goshop"</span>) &gt; <span class="number">-1</span> || href.indexOf(<span class="string">"taobao.com"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">                    ev.preventDefault();</span><br><span class="line">                    ev.stopImmediatePropagation();</span><br><span class="line">                    showOverlay();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">scrollHander</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $<span class="built_in">window</span>.on(<span class="string">"scroll.TOPOVERLAY"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> ($<span class="built_in">window</span>.scrollTop() &gt; <span class="number">10</span>) &#123;</span><br><span class="line">                    hideOverlay();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">showOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $(topoverlaySelector).length ? $(topoverlaySelector).show() : $(<span class="string">"body"</span>).append(OLSB.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">hideOverlay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $(topoverlaySelector).hide();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            buildOverlay();</span><br><span class="line">            bindAutoShow();</span><br><span class="line">            scrollHander();</span><br><span class="line">            bindLiveEvent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        isFromWeixin ? setup() : <span class="string">""</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;(FLNS.register(<span class="string">'NS'</span>)));</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    Super.H5.Wechat.TopOverlay();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;!-- MarkdownTOC --&gt;
&lt;ul&gt;
&lt;li&gt;第一种：引用执行&lt;/li&gt;
&lt;li&gt;第二种：将命名空间传递进&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="js" scheme="https://wangchloe.vip/tags/js/"/>
    
      <category term="项目总结" scheme="https://wangchloe.vip/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>浏览器模拟app环境、微信环境</title>
    <link href="https://wangchloe.vip/2017/09/10/blog56/"/>
    <id>https://wangchloe.vip/2017/09/10/blog56/</id>
    <published>2017-09-10T07:38:57.000Z</published>
    <updated>2017-09-10T07:38:57.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><a id="more"></a><h3 id="Chrome内"><a href="#Chrome内" class="headerlink" title="Chrome内"></a>Chrome内</h3><ul><li>模拟app环境</li></ul><p>F12-&gt;</p><p>Settings-&gt; Devices-&gt; Add custom device-&gt; 填写尺寸、user agent填写<code>fanli</code>-&gt; Add</p><p>关闭或者切换模拟器即可</p><hr><ul><li>模拟微信环境</li></ul><p>F12-&gt;</p><p>Settings-&gt; Devices-&gt; Add custom device-&gt; 填写尺寸、user agent填写<code>micromessenger</code>-&gt; Add</p><p>关闭或者切换模拟器即可</p><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="前端周边" scheme="https://wangchloe.vip/tags/%E5%89%8D%E7%AB%AF%E5%91%A8%E8%BE%B9/"/>
    
  </entry>
  
  <entry>
    <title>淘口令分享</title>
    <link href="https://wangchloe.vip/2017/08/05/blog53/"/>
    <id>https://wangchloe.vip/2017/08/05/blog53/</id>
    <published>2017-08-05T07:11:14.000Z</published>
    <updated>2019-07-24T07:11:14.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>以下内容若有问题烦请即时告知我予以修改，以免误导更多人。</p><hr><!-- MarkdownTOC --><ul><li>前置需求</li><li>复制问题<ul><li>插件：Clipboard.js</li><li>v1.0</li><li>v2.0</li><li>v3.0</li><li>v4.0</li></ul></li><li>反馈<ul><li>集成smartcopy.js</li></ul></li></ul><!-- /MarkdownTOC --><a id="more"></a><h2 id="前置需求"><a href="#前置需求" class="headerlink" title="前置需求"></a>前置需求</h2><ul><li><p>微信搜索详情页 淘口令弹窗 (ios10与ios10- &amp; android逻辑不同)<br>“//common/plugins/clipboard/clipboard.min.js”,</p></li><li><p>ios10- &amp; android  只能长按复制</p></li><li><p>ios10 可以按钮一键复制</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- dialog start --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_code_dialog"</span> <span class="attr">class</span>=<span class="string">"pop-wrap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pop-box"</span> <span class="attr">id</span>=<span class="string">"J_ready"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"J_dig_close"</span> <span class="attr">class</span>=<span class="string">"close ui-dialog-close"</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"top"</span> <span class="attr">src</span>=<span class="string">"//static2.51fanli.net/super/src/h5/images/waitui/detail/dialog-title.png"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"J_com"</span> <span class="attr">class</span>=<span class="string">"com"</span>&gt;</span>请一键复制下方特殊符号，打开淘宝APP<span class="tag">&lt;<span class="name">br</span>/&gt;</span>即可购买本商品<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"code-wrap"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"J_item_ios"</span> <span class="attr">class</span>=<span class="string">"com-code"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"J_item_code"</span> <span class="attr">class</span>=<span class="string">"com-code"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_copy_btn"</span> <span class="attr">class</span>=<span class="string">"copy-btn"</span>&gt;</span>一键复制<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"go-ali"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"J_go_ali"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>后，打开［手机淘宝］领取xxx元优惠券！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- dialog end --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_taodialog"</span> <span class="attr">class</span>=<span class="string">"taodilog"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> isIos = <span class="regexp">/ip(hone|od|ad)/i</span>.test(ua);</span><br><span class="line"><span class="keyword">var</span> tryUa210 = ua.match(<span class="regexp">/iphone os (\d+)_/i</span>);</span><br><span class="line"><span class="comment">// 淘口令</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">popClick</span>(<span class="params">$wrap</span>) </span>&#123;</span><br><span class="line">    $wrap.on(<span class="string">"click"</span>, <span class="string">".J_item"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        dataWord = $(<span class="keyword">this</span>).data(<span class="string">"word"</span>);</span><br><span class="line">        pid = $(<span class="keyword">this</span>).data(<span class="string">"pid"</span>);</span><br><span class="line">        $(<span class="string">"#J_item_code"</span>).val(dataWord);</span><br><span class="line">        $(<span class="string">"#J_item_ios"</span>).text(dataWord);</span><br><span class="line">        $dialog.show();</span><br><span class="line">        $(<span class="string">"#J_taodialog"</span>).show();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tryUa210 &amp;&amp; tryUa210[<span class="number">1</span>] == <span class="number">10</span>) &#123;</span><br><span class="line">            $(<span class="string">"#J_code_dialog"</span>).addClass(<span class="string">"ios10"</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">"#J_dig_close"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"#J_taodialog"</span>).hide();</span><br><span class="line">        $dialog.hide();</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"#J_taodialog"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"#J_taodialog"</span>).hide();</span><br><span class="line">        $dialog.hide();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindClipboard</span>(<span class="params"></span>) </span>&#123; <span class="comment">//复制淘口令</span></span><br><span class="line"></span><br><span class="line">    $(<span class="string">"#J_item_code"</span>).on(<span class="string">"input"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="keyword">this</span>).val(dataWord);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    selectionIos();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (tryUa210 &amp;&amp; tryUa210[<span class="number">1</span>] == <span class="number">10</span>) &#123;</span><br><span class="line">        $(<span class="string">"#J_com"</span>).css(<span class="string">"visibility"</span>, <span class="string">"hidden"</span>);</span><br><span class="line">        $(<span class="string">"#J_go_ali"</span>).html(<span class="string">"复制"</span>);</span><br><span class="line">        $(<span class="string">"#J_item_code"</span>).show().addClass(<span class="string">"none"</span>);</span><br><span class="line">        <span class="keyword">var</span> clipboard = <span class="keyword">new</span> Clipboard(<span class="string">"#J_copy_btn"</span>, &#123;</span><br><span class="line">            target: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">document</span>.querySelector(<span class="string">"#J_item_code"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        clipboard.on(<span class="string">'success'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            e.trigger.innerHTML = <span class="string">"已复制"</span>;</span><br><span class="line">            $(<span class="string">"#J_ready"</span>).addClass(<span class="string">"ready"</span>);</span><br><span class="line">            e.clearSelection();</span><br><span class="line">            UBT.track(<span class="string">"super_tuiguang_mj.h5.pty-copy_kl~pid-&#123;0&#125;~std-29412"</span>.format(pid));</span><br><span class="line">        &#125;);</span><br><span class="line">        clipboard.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            Toast.open(<span class="string">"复制失败，请长按后复制特殊符号！"</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $(<span class="string">"#J_copy_btn"</span>).remove();</span><br><span class="line">        $(<span class="string">"#J_item_code"</span>).addClass(<span class="string">"radius-all"</span>);</span><br><span class="line">        $(<span class="string">"#J_item_ios"</span>).addClass(<span class="string">"radius-all"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectionIos</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isIos) &#123;</span><br><span class="line">        $(<span class="string">"#J_com"</span>).html(<span class="string">"长按框内&gt;复制"</span>);</span><br><span class="line">        $(<span class="string">"#J_go_ali"</span>).html(<span class="string">"复制"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $(<span class="string">"#J_item_ios"</span>).show();</span><br><span class="line">    $(<span class="string">"#J_item_code"</span>).hide();</span><br><span class="line">    $(<span class="string">"#J_com"</span>).html(<span class="string">"长按框内&gt;拷贝"</span>);</span><br><span class="line">    $(<span class="string">"#J_go_ali"</span>).html(<span class="string">"拷贝"</span>);</span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">"selectionchange"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">document</span>.getElementById(<span class="string">'J_item_ios'</span>).innerText != <span class="built_in">window</span>.getSelection()) &#123;</span><br><span class="line">            <span class="keyword">var</span> key = <span class="built_in">document</span>.getElementById(<span class="string">'J_item_ios'</span>);</span><br><span class="line">            <span class="built_in">window</span>.getSelection().selectAllChildren(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="复制问题"><a href="#复制问题" class="headerlink" title="复制问题"></a>复制问题</h2><h3 id="插件：Clipboard-js"><a href="#插件：Clipboard-js" class="headerlink" title="插件：Clipboard.js"></a>插件：Clipboard.js</h3><ul><li><p><code>document.queryCommandSupported(copy/cut)</code></p><ul><li><p>支持   -&gt; 一键复制</p></li><li><p>不支持 -&gt; 长按复制</p><ul><li>目前测试的不支持版本：ios10-</li></ul></li></ul></li></ul><h3 id="v1-0"><a href="#v1-0" class="headerlink" title="v1.0"></a>v1.0</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"code-wrap"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"J_copy_text"</span> <span class="attr">class</span>=<span class="string">"copy-text"</span>&gt;</span>《mxoy03LIzbI《<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>一键复制问题：</li></ul><p>安卓不能获取<code>&lt;p&gt;&lt;/p&gt;</code>标签的复制文本，只能自行长按复制。</p><ul><li>解决方案：</li></ul><p><code>&lt;p&gt;</code> -&gt; <code>&lt;textarea&gt;</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"code-wrap"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 长按复制 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"J_item_ios"</span> <span class="attr">class</span>=<span class="string">"copy-code code-ios"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span>《GjSe0euD5uG《<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 一键复制 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"J_copy_code"</span> <span class="attr">class</span>=<span class="string">"copy-code"</span> <span class="attr">spellcheck</span>=<span class="string">"false"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>《GjSe0euD5uG《<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="v2-0"><a href="#v2-0" class="headerlink" title="v2.0"></a>v2.0</h3><ul><li>一键复制问题：</li></ul><p><code>&lt;textarea&gt;&lt;/textarea&gt;</code>用户可自行修改复制文本。</p><ul><li>解决方案：</li></ul><p>需禁止用户修改输入框，js强制控制。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">$copyCode.on(&quot;input&quot;, function() &#123;</span><br><span class="line">        $(this).val(text);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="v3-0"><a href="#v3-0" class="headerlink" title="v3.0"></a>v3.0</h3><ul><li>长按复制问题：</li></ul><p>用户自行复制，较长文本可能漏了一截没有复制，用户体验差。</p><ul><li>解决方案：</li></ul><p>监听selectionchange事件，若选中的与需复制文本不符，则强制window.getSelection().selectAllChildren()复制全部文本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    function selectionIos() &#123;</span><br><span class="line">        if (!Device.Utility.Browser.versions.ios) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        document.addEventListener(&quot;selectionchange&quot;, function(e) &#123;</span><br><span class="line">            if (document.getElementById(&apos;J_item_ios&apos;).innerText != window.getSelection()) &#123;</span><br><span class="line">                var key = document.getElementById(&apos;J_item_ios&apos;);</span><br><span class="line">                window.getSelection().selectAllChildren(key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, false);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="v4-0"><a href="#v4-0" class="headerlink" title="v4.0"></a>v4.0</h3><p>长按复制问题：</p><ul><li><p>iphone5s测试时，由于rem导致的小屏手机复制文本偏小，可摁区域有限，长按复制经常点不到可复制区域。</p></li><li><p>经ui同意调整字号，使用户体验更佳。</p></li></ul><h1 id="反馈"><a href="#反馈" class="headerlink" title="反馈"></a>反馈</h1><ul><li>settings 动态html ✓</li><li>selector优化 ✓</li><li>多个selectionchange销毁 ✓</li><li>一键复制定制按钮点击</li></ul><h3 id="集成smartcopy-js"><a href="#集成smartcopy-js" class="headerlink" title="集成smartcopy.js"></a>集成smartcopy.js</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"smartcopy-wrapper J_smartcopy_wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>复制1(自定义模版)<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"J_copy_type"</span> <span class="attr">class</span>=<span class="string">"copy-type"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"J_press_copy press-copy"</span>&gt;</span>￥DADoafiFojoY￥<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"J_click_copy"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"J_copy_code"</span> <span class="attr">spellcheck</span>=<span class="string">"false"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">readonly</span>=<span class="string">"readonly"</span>&gt;</span>￥DADoafiFojoY￥<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"J_copy_btn fui-btn fui-btn-s fui-btn-green"</span>&gt;</span>复制<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"smartcopy-wrapper J_smartcopy_wrapper2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>复制2(默认模版)<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $.smartcopy(&#123;</span></span><br><span class="line"><span class="javascript">        onCopySuccess: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// 复制成功</span></span></span><br><span class="line"><span class="javascript">            alert(<span class="string">"复制成功！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, </span></span><br><span class="line"><span class="javascript">        onCopyFail: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// 复制失败</span></span></span><br><span class="line"><span class="javascript">            alert(<span class="string">"复制失败！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, </span></span><br><span class="line"><span class="javascript">        supportCallback: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//支持复制功能回调</span></span></span><br><span class="line"><span class="javascript">            $(<span class="string">"#J_copy_type"</span>).text(<span class="string">"复制方式：支持一键复制，请点击复制按钮！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, </span></span><br><span class="line"><span class="javascript">        notSupportCallback: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//当不支持复制功能时回调</span></span></span><br><span class="line"><span class="javascript">            $(<span class="string">"#J_copy_type"</span>).text(<span class="string">"复制方式：不支持一键复制，请长按文本框复制！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        defaultTpl: <span class="literal">false</span></span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $.smartcopy(&#123;</span></span><br><span class="line"><span class="javascript">        copyText: <span class="string">"￥Sjxs0UccWFD￥"</span>,  </span></span><br><span class="line"><span class="javascript">        copyWrapSelector: <span class="string">".J_smartcopy_wrapper2"</span>,</span></span><br><span class="line"><span class="javascript">        onCopySuccess: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// 复制成功</span></span></span><br><span class="line"><span class="javascript">            alert(<span class="string">"复制成功！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, </span></span><br><span class="line"><span class="javascript">        onCopyFail: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// 复制失败</span></span></span><br><span class="line"><span class="javascript">            alert(<span class="string">"复制失败！"</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, </span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///&lt;reference path="../vendors/jquery/jquery.js" /&gt;</span></span><br><span class="line"><span class="comment">///&lt;reference path="//webapp/js/base.js"" /&gt;</span></span><br><span class="line"><span class="comment">///&lt;reference path="../core/fmu.js" /&gt;</span></span><br><span class="line"><span class="comment">///&lt;reference path="../vendors/clipboard/clipboard.min.js" /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file smartcopy</span></span><br><span class="line"><span class="comment"> * @import core/fmu.js, vendors/jquery/jquery-2.1.1.js,vendors/clipboard/clipboard.min.js</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">##参数</span></span><br><span class="line"><span class="comment">   *copyWrapSelector: ".J_smartcopy_wrapper",  // 多个一键复制框时需定义不同的wrap</span></span><br><span class="line"><span class="comment">    copyCodeSelector: ".J_copy_code", // 待复制文本     </span></span><br><span class="line"><span class="comment">    clickCopySelector: ".J_click_copy",  // 一键复制</span></span><br><span class="line"><span class="comment">    copyBtnSelector: ".J_copy_btn",  // 一键复制按钮</span></span><br><span class="line"><span class="comment">    pressCopySelector: ".J_press_copy",  // 长按复制</span></span><br><span class="line"><span class="comment">    onCopySuccess: $.noop, // 复制成功回调</span></span><br><span class="line"><span class="comment">    onCopyFail: $.noop, //复制失败回调</span></span><br><span class="line"><span class="comment">    supportCallback: $.noop, //支持复制功能回调</span></span><br><span class="line"><span class="comment">    notSupportCallback: $.noop, // 不支持复制功能时回调</span></span><br><span class="line"><span class="comment">    defaultTpl: true, // 使用默认模版</span></span><br><span class="line"><span class="comment">   *copyText: "",  // 使用默认模块时需传入待复制文本内容</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> (<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">    $.extend(&#123;</span><br><span class="line">        smartcopy: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> settings = $.extend(<span class="literal">true</span>, &#123;&#125;, &#123;</span><br><span class="line">                copyWrapSelector: <span class="string">".J_smartcopy_wrapper"</span>,</span><br><span class="line">                copyCodeSelector: <span class="string">".J_copy_code"</span>,</span><br><span class="line">                clickCopySelector: <span class="string">".J_click_copy"</span>,</span><br><span class="line">                copyBtnSelector: <span class="string">".J_copy_btn"</span>,</span><br><span class="line">                pressCopySelector: <span class="string">".J_press_copy"</span>,</span><br><span class="line">                onCopySuccess: $.noop,</span><br><span class="line">                onCopyFail: $.noop,</span><br><span class="line">                supportCallback: $.noop,</span><br><span class="line">                notSupportCallback: $.noop,</span><br><span class="line">                defaultTpl: <span class="literal">true</span>,</span><br><span class="line">                copyText: <span class="string">""</span>,</span><br><span class="line">            &#125;, options);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> $scTpl = $(<span class="string">'&lt;p class="J_press_copy press-copy"&gt;&#123;0&#125;&lt;/p&gt;\</span></span><br><span class="line"><span class="string">                &lt;div class="J_click_copy"&gt;\</span></span><br><span class="line"><span class="string">                &lt;textarea class="J_copy_code" spellcheck="false" type="text" readonly="readonly"&gt;&#123;0&#125;&lt;/textarea&gt;\</span></span><br><span class="line"><span class="string">                &lt;button class="J_copy_btn fui-btn fui-btn-s fui-btn-green"&gt;复制&lt;/button&gt;\</span></span><br><span class="line"><span class="string">                &lt;/div&gt;'</span>.format(settings.copyText));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> $copyWrap = $(settings.copyWrapSelector);</span><br><span class="line">            <span class="keyword">var</span> pressCopySelector =  settings.copyWrapSelector + <span class="string">' '</span> + settings.pressCopySelector;</span><br><span class="line">            <span class="keyword">var</span> copyBtnSelector = settings.copyWrapSelector + <span class="string">' '</span> + settings.copyBtnSelector;</span><br><span class="line">            <span class="keyword">var</span> copyCodeSelector = settings.copyWrapSelector + <span class="string">' '</span> + settings.copyCodeSelector;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> $clickCopy, $pressCopy;</span><br><span class="line">            <span class="keyword">var</span> isSelected = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                initClipboard();</span><br><span class="line">                bindClipboard();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">initClipboard</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                settings.defaultTpl &amp;&amp; $scTpl.appendTo($copyWrap);</span><br><span class="line"></span><br><span class="line">                $clickCopy = $(settings.clickCopySelector, settings.copyWrapSelector);</span><br><span class="line">                $pressCopy = $(settings.pressCopySelector, settings.copyWrapSelector);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">bindClipboard</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (Clipboard.isSupported()) &#123;  <span class="comment">// 一键复制</span></span><br><span class="line">                    $clickCopy.show();</span><br><span class="line">                    $pressCopy.hide();</span><br><span class="line"></span><br><span class="line">                    settings.supportCallback();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> clipboard = <span class="keyword">new</span> Clipboard(copyBtnSelector, &#123;</span><br><span class="line">                        target: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="built_in">document</span>.querySelector(copyCodeSelector);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">console</span>.log(clipboard);</span><br><span class="line"></span><br><span class="line">                    clipboard.on(<span class="string">'success'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">                        settings.onCopySuccess();</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    clipboard.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">                        settings.onCopyFail();</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;  <span class="comment">//长按复制(不支持多个)</span></span><br><span class="line">                    settings.notSupportCallback();</span><br><span class="line">                    selectionIos();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">selectionIos</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (!Device.Utility.Browser.versions.ios) &#123; </span><br><span class="line">                    settings.onCopyFail();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                $clickCopy.hide();</span><br><span class="line">                $pressCopy.show();</span><br><span class="line"></span><br><span class="line">                <span class="built_in">document</span>.removeEventListener(<span class="string">"selectionchange"</span>, selectEvent, <span class="literal">false</span>);</span><br><span class="line">                <span class="built_in">document</span>.addEventListener(<span class="string">"selectionchange"</span>, selectEvent, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">selectEvent</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(isSelected) &#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">document</span>.querySelector(pressCopySelector).innerText != <span class="built_in">window</span>.getSelection()) &#123;</span><br><span class="line">                    <span class="keyword">var</span> key = <span class="built_in">document</span>.querySelector(pressCopySelector);</span><br><span class="line">                    <span class="built_in">window</span>.getSelection().selectAllChildren(key);</span><br><span class="line">                    isSelected = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            setup();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;(jQuery));</span><br></pre></td></tr></table></figure><hr><p>更多内容可以订阅本人微信公众号，一起开启前端小白进阶的世界！<br><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g59sd1aky1j325s0m80xf.jpg" alt="微信公众号：无媛无故"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以下内容若有问题烦请即时告知我予以修改，以免误导更多人。&lt;/p&gt;
&lt;hr&gt;
&lt;!-- MarkdownTOC --&gt;
&lt;ul&gt;
&lt;li&gt;前置需求&lt;/li&gt;
&lt;li&gt;复制问题&lt;ul&gt;
&lt;li&gt;插件：Clipboard.js&lt;/li&gt;
&lt;li&gt;v1.0&lt;/li&gt;
&lt;li&gt;v2.0&lt;/li&gt;
&lt;li&gt;v3.0&lt;/li&gt;
&lt;li&gt;v4.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;反馈&lt;ul&gt;
&lt;li&gt;集成smartcopy.js&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;
    
    </summary>
    
      <category term="前端札记" scheme="https://wangchloe.vip/categories/%E5%89%8D%E7%AB%AF%E6%9C%AD%E8%AE%B0/"/>
    
    
      <category term="项目总结" scheme="https://wangchloe.vip/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
</feed>
